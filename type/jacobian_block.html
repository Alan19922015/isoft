<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Ice Shelf/Ocean Fluid- and Thermodynamics: a suite of tools and programs to use for simulating the evolution of ice shelves interacting with the ocean.">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>jacobian_block &ndash; ISOFT </title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ISOFT </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>jacobian_block
    <small>Derived Type</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     <li><i class="fa fa-pencil"></i> Chris MacMackin</li>
     
     
    <li><i class="fa fa-calendar-o"></i> December 2016</li>
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="<p> 5.1% of total for derived types.</p>Including implementation: 402 statements,  6.6% of total for derived types.">36 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/jacobian_block.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/jacobian_block.f90.html'>jacobian_block.F90</a></li>
    
     <li><a href='../module/jacobian_block_mod.html'>jacobian_block_mod</a></li>
    
  
     <li class="active">jacobian_block</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-direction">direction</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-extra_derivative">extra_derivative</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-contents">contents</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-coef">coef</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-get_boundaries">get_boundaries</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-derivative">derivative</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-diagonal">diagonal</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-super_diagonal">super_diagonal</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-sub_diagonal">sub_diagonal</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-l_multipliers">l_multipliers</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-u_diagonal">u_diagonal</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-u_superdiagonal1">u_superdiagonal1</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-u_superdiagonal2">u_superdiagonal2</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-pivots">pivots</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-boundary_vals">boundary_vals</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-boundary_locs">boundary_locs</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-boundary_types">boundary_types</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-real_increment">real_increment</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-field_increment">field_increment</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-block_increment">block_increment</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-has_increment">has_increment</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#cons-0">Constructor</a></h3></div>
  <div id="cons-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../type/jacobian_block.html#interface-jacobian_block">jacobian_block</a>
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-0">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_multiply">jacobian_block_multiply</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_add_real">jacobian_block_add_real</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_add_field">jacobian_block_add_field</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_add_block">jacobian_block_add_block</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_assign">jacobian_block_assign</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-get_tridiag">get_tridiag</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-operator%28%2A%29">operator(*)</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-operator%28%2B%29">operator(+)</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-assignment%28%3D%29%7E3">assignment(=)</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-solve_for%7E3">solve_for</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../type/jacobian_block.html#src">jacobian_block</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>type, public :: jacobian_block</h2>
    <p>A data type representing a submatrix of a
 Jacobian. Specifically, it represents the commonly occurring
 operation <script type="math/tex; mode=display"> \frac{\partial F}{\partial x_i} + F\Delta_i, </script>
 where <script type="math/tex"> \Delta_i </script> is the differentiation operator in the
 <script type="math/tex">i</script>-direction. Optionally, there can be an additional
 differentiation operator on the right-hand-side of this.</p>
<p>This data type is useful when constructing a preconditioner. A
 preconditioner, <script type="math/tex">A</script>, should approximate the inverse Jacobian of
 a problem being solved. Rather than directly computing the
 inverse Jacobian, it is more efficient to approximate it. If
 <script type="math/tex">d</script> is the vector being preconditioned, and <script type="math/tex">z</script> is the
 result of applying the preconditioner, then <script type="math/tex; mode=display"> z = J^{-1}d
 \Rightarrow Jz = d.</script> Thus, the preconditioner can be applied
 by approximately solving this system for <script type="math/tex">z</script>. Linearising
 <script type="math/tex">J</script>, this system can be solved efficiently using Picard
 iteration.</p>
<p>Say that the Jacobian is an <script type="math/tex">n\times n</script> system of these blocks
 (each labeled as <script type="math/tex">J_{j,k}</script>) and that the vector being
 preconditioned constists of <script type="math/tex">n</script> scalar fields (<script type="math/tex">d_j</script>). Then
 the <script type="math/tex">m^{th}</script> estimate of the solution for the <script type="math/tex">j^{th}</script> field
 in the preconditioned vector (<script type="math/tex">z^m_j</script>) is the solution to <script type="math/tex; mode=display">
 J_{j,j}z^m_j = d_j - \sum_{\substack{k=1\ k\ne j}}^n
 J_{j,k}z^{m-1}_k. </script> Depending on the type of fields being used
 and the direction in which derivatives are being taken,
 <script type="math/tex">J_{j,j}</script> may be tridiaganol, meaning it can be solved
 efficiently. <!--Otherwise, it can be approximated that <script type="math/tex; mode=display">
 J_{j,j}z^m_j = \left(\frac{\partial F}{\partial x_i} +
 F\Delta_i\right)z^{m} \simeq \frac{\partial F}{\partial
 x_i}z^m_j + F\frac{\partial z^{m-1}_j}{\partial x_i}. </script> The
 first term in this approximation corresponds to a diagonal
 matrix (which can be solved trivially), while the second term is
 known and can be subtracted from the right-hand-side of the
 linear system.--></p>
<p>For this purpose, a type-bound multiplication operator is
 provided for the Jacobian block type, which can be used when
 evaluating the right hand side of the linear system. There is
 also a <code>solve_for</code> method, which takes as an argument the field
 representing the right hand side of the system. <!--Before
 applying the latter operator, the <code>update_estimate</code> method must
 be called. This allows for the term involving derivative of the
 current estimate of the solution to be subtracted from the
 right-hand-side of the linear system, in cases where the system
 can not be expressed as a tridiagonal matrix.--></p>
<p>Boundary conditions are a complicated issue. When constructing
 an instance of this type, locations in the raw field
 representation can be specified for which boundary conditions
 are given. By default these are all Dirichlet conditions, but
 this behaviour may be overridden to be Neumann conditions. Note
 that Neumann conditions result in approximately an order of
 magnitude lower accuracy. When using the Jacobian block for
 multiplation, the type of the boundary does not matter; the
 value at the boundary in the result will be set to 0 or to
 values produced by an optional user-provided function. When
 using the <code>solve_for</code> method, the tridiagonal matrix will be
 altered in the specified locations to reflect the correct
 boundary conditions. This effectively mimics the sorts of
 Jacobian rows typically produced by boundary conditions.</p>
    <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Inherits</h3>
      </div>
      <div class="panel-body">
    <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: type~~jacobian_block~~InheritsGraph Pages: 1 -->
<svg id="typejacobian_blockInheritsGraph" width="350pt" height="60pt"
 viewBox="0.00 0.00 350.00 60.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="type~~jacobian_block~~InheritsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 56)">
<title>type~~jacobian_block~~InheritsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-56 346,-56 346,4 -4,4"/>
<!-- type~jacobian_block -->
<g id="type~~jacobian_block~~InheritsGraph_node1" class="node"><title>type~jacobian_block</title>
<polygon fill="none" stroke="black" points="341.5,-24 258.5,-24 258.5,-0 341.5,-0 341.5,-24"/>
<text text-anchor="middle" x="300" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">jacobian_block</text>
</g>
<!-- type~jacobian_block&#45;&gt;type~jacobian_block -->
<g id="type~~jacobian_block~~InheritsGraph_edge2" class="edge"><title>type~jacobian_block&#45;&gt;type~jacobian_block</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M322.487,-24.0139C330.339,-32.9717 322.844,-42 300,-42 286.08,-42 277.859,-38.6474 275.337,-34.0013"/>
<polygon fill="#000000" stroke="#000000" points="278.804,-34.5298 277.513,-24.0139 271.964,-33.0394 278.804,-34.5298"/>
<text text-anchor="middle" x="300" y="-44.4" font-family="Helvetica,sans-Serif" font-size="9.50">block_increment</text>
</g>
<!-- scalar_field -->
<g id="type~~jacobian_block~~InheritsGraph_node2" class="node"><title>scalar_field</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="67.5,-24 0.5,-24 0.5,-0 67.5,-0 67.5,-24"/>
<text text-anchor="middle" x="34" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scalar_field</text>
</g>
<!-- type~jacobian_block&#45;&gt;scalar_field -->
<g id="type~~jacobian_block~~InheritsGraph_edge1" class="edge"><title>type~jacobian_block&#45;&gt;scalar_field</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M258.329,-12C209.447,-12 127.791,-12 77.9267,-12"/>
<polygon fill="#000000" stroke="#000000" points="77.7919,-8.5001 67.7919,-12 77.7919,-15.5001 77.7919,-8.5001"/>
<text text-anchor="middle" x="163" y="-14.4" font-family="Helvetica,sans-Serif" font-size="9.50">contents, derivative, field_increment</text>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="177pt" height="32pt"
 viewBox="0.00 0.00 177.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 173,-28 173,4 -4,4"/>
<!-- Type -->
<g id="node1" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="169.25,-24 72.75,-24 72.75,-0 169.25,-0 169.25,-24"/>
<text text-anchor="middle" x="121" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a derived type to the parent type which it
    extends. Dashed arrows point from a derived type to the other
    types it contains as a components, with a label listing the name(s) of
    said component(s).
    </p>
    </div></div></div></div>
      </div>
    </div>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Inherited by</h3>
      </div>
      <div class="panel-body">
     <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: type~~jacobian_block~~InheritedByGraph Pages: 1 -->
<svg id="typejacobian_blockInheritedByGraph" width="342pt" height="60pt"
 viewBox="0.00 0.00 342.00 60.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="type~~jacobian_block~~InheritedByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 56)">
<title>type~~jacobian_block~~InheritedByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-56 338,-56 338,4 -4,4"/>
<!-- type~jacobian_block -->
<g id="type~~jacobian_block~~InheritedByGraph_node1" class="node"><title>type~jacobian_block</title>
<polygon fill="none" stroke="black" points="83.5,-24 0.5,-24 0.5,-0 83.5,-0 83.5,-24"/>
<text text-anchor="middle" x="42" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">jacobian_block</text>
</g>
<!-- type~jacobian_block&#45;&gt;type~jacobian_block -->
<g id="type~~jacobian_block~~InheritedByGraph_edge2" class="edge"><title>type~jacobian_block&#45;&gt;type~jacobian_block</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M64.8175,-24.0139C72.7855,-32.9717 65.1797,-42 42,-42 27.8749,-42 19.5329,-38.6474 16.9741,-34.0013"/>
<polygon fill="#000000" stroke="#000000" points="20.4409,-34.5337 19.1825,-24.0139 13.6059,-33.0224 20.4409,-34.5337"/>
<text text-anchor="middle" x="42" y="-44.4" font-family="Helvetica,sans-Serif" font-size="9.50">block_increment</text>
</g>
<!-- type~ice_shelf -->
<g id="type~~jacobian_block~~InheritedByGraph_node2" class="node"><title>type~ice_shelf</title>
<g id="a_type~~jacobian_block~~InheritedByGraph_node2"><a xlink:href=".././type/ice_shelf.html" xlink:title="ice_shelf">
<polygon fill="#5cb85c" stroke="#5cb85c" points="333.5,-24 278.5,-24 278.5,-0 333.5,-0 333.5,-24"/>
<text text-anchor="middle" x="306" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ice_shelf</text>
</a>
</g>
</g>
<!-- type~ice_shelf&#45;&gt;type~jacobian_block -->
<g id="type~~jacobian_block~~InheritedByGraph_edge1" class="edge"><title>type~ice_shelf&#45;&gt;type~jacobian_block</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.436,-12C235.294,-12 149.267,-12 94.0084,-12"/>
<polygon fill="#000000" stroke="#000000" points="93.7275,-8.5001 83.7274,-12 93.7274,-15.5001 93.7275,-8.5001"/>
<text text-anchor="middle" x="181" y="-14.4" font-family="Helvetica,sans-Serif" font-size="9.50">thickness_jacobian, velocity_jacobian</text>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="177pt" height="32pt"
 viewBox="0.00 0.00 177.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 173,-28 173,4 -4,4"/>
<!-- Type -->
<g id="node1" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="169.25,-24 72.75,-24 72.75,-0 169.25,-0 169.25,-24"/>
<text text-anchor="middle" x="121" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a derived type to the parent type which it
    extends. Dashed arrows point from a derived type to the other
    types it contains as a components, with a label listing the name(s) of
    said component(s).
    </p>
    </div></div></div></div>
      </div>
    </div>
    
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-direction">direction</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-extra_derivative">extra_derivative</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-contents">contents</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-coef">coef</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-get_boundaries">get_boundaries</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-derivative">derivative</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-diagonal">diagonal</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-super_diagonal">super_diagonal</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-sub_diagonal">sub_diagonal</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-l_multipliers">l_multipliers</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-u_diagonal">u_diagonal</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-u_superdiagonal1">u_superdiagonal1</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-u_superdiagonal2">u_superdiagonal2</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-pivots">pivots</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-boundary_vals">boundary_vals</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-boundary_locs">boundary_locs</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-boundary_types">boundary_types</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-real_increment">real_increment</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-field_increment">field_increment</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-block_increment">block_increment</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#variable-has_increment">has_increment</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#cons-1">Constructor</a></h3></div>
  <div id="cons-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../type/jacobian_block.html#interface-jacobian_block">jacobian_block</a>
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-1">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_multiply">jacobian_block_multiply</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_add_real">jacobian_block_add_real</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_add_field">jacobian_block_add_field</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_add_block">jacobian_block_add_block</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-jacobian_block_assign">jacobian_block_assign</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-get_tridiag">get_tridiag</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-operator%28%2A%29">operator(*)</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-operator%28%2B%29">operator(+)</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-assignment%28%3D%29%7E3">assignment(=)</a>
      
      <a class="list-group-item" href="../type/jacobian_block.html#boundprocedure-solve_for%7E3">solve_for</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../type/jacobian_block.html#src">jacobian_block</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
    <h2>Components</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-direction"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>direction</strong></td><td></td><td></td><td><p>The direction in which any derivatives are taken.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-extra_derivative"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>extra_derivative</strong></td><td> =</td><td>no_extra_derivative</td><td><p>The direction in which to apply a differentiation on the
 right-hand-side of the Jacobian block operator. Defaults
 none.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-contents"></span>class(scalar_field),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>contents</strong></td><td></td><td></td><td><p>The value, <script type="math/tex">A</script>, to which the Jacobian block operation is
 beiing applied.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-coef"></span>real(kind=r8),</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>coef</strong></td><td> =</td><td>1._r8</td><td><p>Optional coefficient by which the the <script type="math/tex">\partial F/\partial x
 </script> term in the operator will be multiplied.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-get_boundaries"></span>procedure(<a href='../proc/jacobian_block_bounds.html'>jacobian_block_bounds</a>),</td>
  
  <td>private,</td>
  <td>pointer, nopass</td><td>::</td>
  <td><strong>get_boundaries</strong></td><td></td><td></td><td><p>A subroutine which determines the expected boundary conditions
 (and their location in the raw array) for the solution of the
 Jacobian block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-derivative"></span>class(scalar_field),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>derivative</strong></td><td></td><td></td><td><p>The cached derivative of <code>contents</code></p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-diagonal"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>diagonal</strong></td><td></td><td></td><td><p>The diagonal of the tridiagonal matrix representation of this
 block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-super_diagonal"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>super_diagonal</strong></td><td></td><td></td><td><p>The super-diagonal of the tridiagonal matrix representation
 of this block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-sub_diagonal"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>sub_diagonal</strong></td><td></td><td></td><td><p>The sub-diagonal of the tridiagonal matrix representation of
 this block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-l_multipliers"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>l_multipliers</strong></td><td></td><td></td><td><p>Multipliers defining the L matrix in the LU factorisation of
 the tridiagonal matrix representation of this block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-u_diagonal"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>u_diagonal</strong></td><td></td><td></td><td><p>The diagonal of the U matrix in the LU factorisation of
 the tridiagonal matrix representation of this block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-u_superdiagonal1"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>u_superdiagonal1</strong></td><td></td><td></td><td><p>The first superdiagonal of the U matrix in the LU
 factorisation of the tridiagonal matrix representation of
 this block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-u_superdiagonal2"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>u_superdiagonal2</strong></td><td></td><td></td><td><p>The second superdiagonal of the U matrix in the LU
 factorisation of the tridiagonal matrix representation of
 this block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pivots"></span>integer,</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>pivots</strong></td><td></td><td></td><td><p>Pivot indicies from the LU factorisation of the tridiagonal
 matrix representation of this block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-boundary_vals"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>boundary_vals</strong></td><td></td><td></td><td><p>Expected boundary values for the solution to the Jacobian
 block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-boundary_locs"></span>integer,</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>boundary_locs</strong></td><td></td><td></td><td><p>Locations in the raw arrays which are used to specify
 boundary conditions.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-boundary_types"></span>integer,</td>
  
  <td>private,</td>
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>boundary_types</strong></td><td></td><td></td><td><p>The types of boundary conditions, specified using the
 parameters found in <a href="../module/boundary_types_mod.html">boundary_types_mod</a>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-real_increment"></span>real(kind=r8),</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>real_increment</strong></td><td></td><td></td><td><p>A scalar value which is to be added to this Jacobian block
 (i.e. to the diagonal).</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-field_increment"></span>class(scalar_field),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>field_increment</strong></td><td></td><td></td><td><p>A scalar field which is to be added to this Jacobian block
 (i.e. to the diagonal).</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-block_increment"></span>type(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  
  <td>private,</td>
  <td>pointer</td><td>::</td>
  <td><strong>block_increment</strong></td><td>=> </td><td>null()</td><td><p>Another Jacobian block which is to be added to this one</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-has_increment"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>has_increment</strong></td><td> =</td><td>0</td><td><p>Indicates whether or not there has been an increment added to
 this block. If not, then 0. If a scalar real value has been
 added, then 1. If a scalar value has been added, then 2.</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
   <section>
   <h2>Constructor</h2>
     
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-jacobian_block"></span><h3>public interface <a href='../interface/jacobian_block.html'>jacobian_block</a>
    
  </h3></div>
  
  <ul class="list-group">
  
  
  
    <li class="list-group-item">
    
    
    <h3>
private function <a href='../proc/constructor%7E6.html'>constructor</a>(source_field, direction, extra_derivative, boundary_locs, boundary_types, boundary_operations, coef) result(this)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2016</dd>
    
    
    
    
  </dl>



<p>Build a block in a Jacobian matrix, with the form
 <script type="math/tex; mode=display">\frac{\partial F}{\partial x_i} + F\Delta_i,</script> where <script type="math/tex">F</script> is
 a scalar field and <script type="math/tex">\Delta_i</script> is the differentiation operator
 in the <script type="math/tex">i</script>-direction. Additionally, a further differentiation
 operator may be added to the right hand side of this matrix
 block.  Optional arguments allow for handling of boundary
 conditions. See the end of the documentation of the
 <a href="../type/jacobian_block.html">jacobian_block</a> type for a description of how boundary
 conditions are treated.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(scalar_field),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>source_field</strong></td><td><p>A scalar field (<script type="math/tex">F</script>) making up this block of the Jacobian</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>direction</strong></td><td><p>The direction in which field derivatives are taken.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>extra_derivative</strong></td><td><p>If present, specifies the direction of a differentiation
 operator to be added to the right hand side of this matrix
 block.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>boundary_locs</strong></td><td><p>The locations in the raw representation of <code>rhs</code> for which
 boundary conditions are specified. Defaults to there being
 none.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>boundary_types</strong></td><td><p>Integers specifying the type of boundary condition. The type
 of boundary condition corresponding to a given integer is
 specified in <a href="../module/boundary_types_mod.html">boundary_types_mod</a>. Only Dirichlet and
 Neumann conditions are supported. Defaults to Dirichlet. The
 order in which they are stored must match that of
 <code>boundary_locs</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../proc/jacobian_block_bounds.html'>jacobian_block_bounds</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>boundary_operations</strong></td><td><p>A function specifying the values to place at the boundaries
 of the result when using the Jacobian block for
 multiplication. By default, all boundaries are set to 0. The
 order in which the resulting values are stored should match
 that of <code>boundary_locs</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>coef</strong></td><td><p>An optional coefficient by which the the <script type="math/tex">\partial
 F/\partial x </script> term in the operator will be
 multipled. Default value is 1.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>type(<a href='../type/jacobian_block.html'>jacobian_block</a>)
  </small></h4>
  <p>A new Jacobian block</p>
    

    </li>
  
  
  </ul>
</div>

     
   </section>
   <br>
    
    
    
    
     
    <section>
    <h2>Type-Bound Procedures</h2>
    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-jacobian_block_multiply"></span><h3>procedure, private :: <strong>jacobian_block_multiply</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private recursive function <a href='../proc/jacobian_block_multiply.html'>jacobian_block_multiply</a>(this, rhs) result(product)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2016</dd>
    
    
    
    
  </dl>



<p>Provides a matrix multiplication operator between a Jacobian
 block and a scalar field (which corresponds to a state vector).</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(scalar_field),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td><p>A field corresponding to a state vector being multiplied by
 the Jacobian block.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>class(scalar_field),
  pointer</small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-jacobian_block_add_real"></span><h3>procedure, private :: <strong>jacobian_block_add_real</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private function <a href='../proc/jacobian_block_add_real.html'>jacobian_block_add_real</a>(this, rhs) result(sum)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2016</dd>
    
    
    
    
  </dl>



<p>Produces a Jacobian block which has been offset by some constant
 increment.</p><a href="../proc/jacobian_block_add_real.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td><p>A scalar which should be added to this block</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>type(<a href='../type/jacobian_block.html'>jacobian_block</a>)
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-jacobian_block_add_field"></span><h3>procedure, private :: <strong>jacobian_block_add_field</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private function <a href='../proc/jacobian_block_add_field.html'>jacobian_block_add_field</a>(this, rhs) result(sum)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>May 2017</dd>
    
    
    
    
  </dl>



<p>Produces a Jacobian block which has been offset by a scalar
 field.</p><a href="../proc/jacobian_block_add_field.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(scalar_field),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td><p>A scalar which should be added to this block</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>type(<a href='../type/jacobian_block.html'>jacobian_block</a>)
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-jacobian_block_add_block"></span><h3>procedure, private :: <strong>jacobian_block_add_block</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private function <a href='../proc/jacobian_block_add_block.html'>jacobian_block_add_block</a>(this, rhs) result(sum)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>May 2017</dd>
    
    
    
    
  </dl>



<p>Produces a Jacobian block which is the sum of two existing
 blocks. Boundary conditions are set by the first operand
 (<code>this</code>).</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>rhs</strong></td><td><p>A second block which should be added to this block</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>type(<a href='../type/jacobian_block.html'>jacobian_block</a>)
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-jacobian_block_assign"></span><h3>procedure, private :: <strong>jacobian_block_assign</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/jacobian_block_assign.html'>jacobian_block_assign</a>(this, rhs)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2016</dd>
    
    
    
    
  </dl>



<p>Copies the contents of the <code>rhs</code> Jacobian block into this
 one. It will safely deallocate any data necessary.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_tridiag"></span><h3>procedure, private :: <strong>get_tridiag</strong>  => <a href='../proc/jacobian_block_get_tridiag.html'>jacobian_block_get_tridiag</a> 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private recursive subroutine <a href='../proc/jacobian_block_get_tridiag.html'>jacobian_block_get_tridiag</a>(this, diagonal, subdiagonal, superdiagonal)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>May 2017</dd>
    
    
    
    
  </dl>



<p>Computes the tridiagonal matrix used to solve for this Jacobian block.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>diagonal</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>subdiagonal</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>superdiagonal</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-operator%28%2A%29"></span><h3>generic, public :: <strong>operator(*)</strong>  => <a href='../type/jacobian_block.html#boundprocedure-jacobian_block_multiply'>jacobian_block_multiply</a> 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
         
            
    
    <h3>
private recursive function <a href='../proc/jacobian_block_multiply.html'>jacobian_block_multiply</a>(this, rhs) result(product)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2016</dd>
    
    
    
    
  </dl>



<p>Provides a matrix multiplication operator between a Jacobian
 block and a scalar field (which corresponds to a state vector).</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(scalar_field),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td><p>A field corresponding to a state vector being multiplied by
 the Jacobian block.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>class(scalar_field),
  pointer</small></h4>
  
    

         
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-operator%28%2B%29"></span><h3>generic, public :: <strong>operator(+)</strong>  => <a href='../type/jacobian_block.html#boundprocedure-jacobian_block_add_real'>jacobian_block_add_real</a>, <a href='../type/jacobian_block.html#boundprocedure-jacobian_block_add_field'>jacobian_block_add_field</a>, <a href='../type/jacobian_block.html#boundprocedure-jacobian_block_add_block'>jacobian_block_add_block</a> 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
         
            
    
    <h3>
private function <a href='../proc/jacobian_block_add_real.html'>jacobian_block_add_real</a>(this, rhs) result(sum)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2016</dd>
    
    
    
    
  </dl>



<p>Produces a Jacobian block which has been offset by some constant
 increment.</p><a href="../proc/jacobian_block_add_real.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td><p>A scalar which should be added to this block</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>type(<a href='../type/jacobian_block.html'>jacobian_block</a>)
  </small></h4>
  
    

         
      
      </li>
    
      <li class="list-group-item">
      
         
            
    
    <h3>
private function <a href='../proc/jacobian_block_add_field.html'>jacobian_block_add_field</a>(this, rhs) result(sum)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>May 2017</dd>
    
    
    
    
  </dl>



<p>Produces a Jacobian block which has been offset by a scalar
 field.</p><a href="../proc/jacobian_block_add_field.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(scalar_field),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td><p>A scalar which should be added to this block</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>type(<a href='../type/jacobian_block.html'>jacobian_block</a>)
  </small></h4>
  
    

         
      
      </li>
    
      <li class="list-group-item">
      
         
            
    
    <h3>
private function <a href='../proc/jacobian_block_add_block.html'>jacobian_block_add_block</a>(this, rhs) result(sum)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>May 2017</dd>
    
    
    
    
  </dl>



<p>Produces a Jacobian block which is the sum of two existing
 blocks. Boundary conditions are set by the first operand
 (<code>this</code>).</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>rhs</strong></td><td><p>A second block which should be added to this block</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>type(<a href='../type/jacobian_block.html'>jacobian_block</a>)
  </small></h4>
  
    

         
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-assignment%28%3D%29%7E3"></span><h3>generic, public :: <strong>assignment(=)</strong>  => <a href='../type/jacobian_block.html#boundprocedure-jacobian_block_assign'>jacobian_block_assign</a> 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
         
            
    
    <h3>
private subroutine <a href='../proc/jacobian_block_assign.html'>jacobian_block_assign</a>(this, rhs)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2016</dd>
    
    
    
    
  </dl>



<p>Copies the contents of the <code>rhs</code> Jacobian block into this
 one. It will safely deallocate any data necessary.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

         
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-solve_for%7E3"></span><h3>procedure, public :: <strong>solve_for</strong>  => <a href='../proc/jacobian_block_solve.html'>jacobian_block_solve</a> 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private function <a href='../proc/jacobian_block_solve.html'>jacobian_block_solve</a>(this, rhs) result(solution)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2016</dd>
    
    
    
    
  </dl>



<p>Solves the linear(ised) system represented by this Jacobian
 block, for a given right hand side state vector (represented by
 a scalar field).</p><a href="../proc/jacobian_block_solve.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/jacobian_block.html'>jacobian_block</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(scalar_field),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td><p>The right hand side of the linear(ised) system.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>class(scalar_field),
  pointer</small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
    </section>
    
    
    
    <section>
    <h3><span class="anchor" id="src"></span>Source Code</h3>
    <div class="highlight"><pre><span></span>  <span class="k">type</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">jacobian_block</span>
    <span class="c">!* Author: Chris MacMackin</span>
    <span class="c">!  Date: December 2016</span>
    <span class="c">!</span>
    <span class="c">! A data type representing a submatrix of a</span>
    <span class="c">! Jacobian. Specifically, it represents the commonly occurring</span>
    <span class="c">! operation $$ \frac{\partial F}{\partial x_i} + F\Delta_i, $$</span>
    <span class="c">! where \( \Delta_i \) is the differentiation operator in the</span>
    <span class="c">! \(i\)-direction. Optionally, there can be an additional</span>
    <span class="c">! differentiation operator on the right-hand-side of this.</span>
    <span class="c">!</span>
    <span class="c">! This data type is useful when constructing a preconditioner. A</span>
    <span class="c">! preconditioner, \(A\), should approximate the inverse Jacobian of</span>
    <span class="c">! a problem being solved. Rather than directly computing the</span>
    <span class="c">! inverse Jacobian, it is more efficient to approximate it. If</span>
    <span class="c">! \(d\) is the vector being preconditioned, and \(z\) is the</span>
    <span class="c">! result of applying the preconditioner, then $$ z = J^{-1}d</span>
    <span class="c">! \Rightarrow Jz = d.$$ Thus, the preconditioner can be applied</span>
    <span class="c">! by approximately solving this system for \(z\). Linearising</span>
    <span class="c">! \(J\), this system can be solved efficiently using Picard</span>
    <span class="c">! iteration.</span>
    <span class="c">!</span>
    <span class="c">! Say that the Jacobian is an \(n\times n\) system of these blocks</span>
    <span class="c">! (each labeled as \(J_{j,k}\)) and that the vector being</span>
    <span class="c">! preconditioned constists of \(n\) scalar fields (\(d_j\)). Then</span>
    <span class="c">! the \(m^{th}\) estimate of the solution for the \(j^{th}\) field</span>
    <span class="c">! in the preconditioned vector (\(z^m_j\)) is the solution to $$</span>
    <span class="c">! J_{j,j}z^m_j = d_j - \sum_{\substack{k=1\ k\ne j}}^n</span>
    <span class="c">! J_{j,k}z^{m-1}_k. $$ Depending on the type of fields being used</span>
    <span class="c">! and the direction in which derivatives are being taken,</span>
    <span class="c">! \(J_{j,j}\) may be tridiaganol, meaning it can be solved</span>
    <span class="c">! efficiently. &lt;!--Otherwise, it can be approximated that $$</span>
    <span class="c">! J_{j,j}z^m_j = \left(\frac{\partial F}{\partial x_i} +</span>
    <span class="c">! F\Delta_i\right)z^{m} \simeq \frac{\partial F}{\partial</span>
    <span class="c">! x_i}z^m_j + F\frac{\partial z^{m-1}_j}{\partial x_i}. $$ The</span>
    <span class="c">! first term in this approximation corresponds to a diagonal</span>
    <span class="c">! matrix (which can be solved trivially), while the second term is</span>
    <span class="c">! known and can be subtracted from the right-hand-side of the</span>
    <span class="c">! linear system.--&gt;</span>
    <span class="c">!</span>
    <span class="c">! For this purpose, a type-bound multiplication operator is</span>
    <span class="c">! provided for the Jacobian block type, which can be used when</span>
    <span class="c">! evaluating the right hand side of the linear system. There is</span>
    <span class="c">! also a `solve_for` method, which takes as an argument the field</span>
    <span class="c">! representing the right hand side of the system. &lt;!--Before</span>
    <span class="c">! applying the latter operator, the `update_estimate` method must</span>
    <span class="c">! be called. This allows for the term involving derivative of the</span>
    <span class="c">! current estimate of the solution to be subtracted from the</span>
    <span class="c">! right-hand-side of the linear system, in cases where the system</span>
    <span class="c">! can not be expressed as a tridiagonal matrix.--&gt;</span>
    <span class="c">!</span>
    <span class="c">! Boundary conditions are a complicated issue. When constructing</span>
    <span class="c">! an instance of this type, locations in the raw field</span>
    <span class="c">! representation can be specified for which boundary conditions</span>
    <span class="c">! are given. By default these are all Dirichlet conditions, but</span>
    <span class="c">! this behaviour may be overridden to be Neumann conditions. Note</span>
    <span class="c">! that Neumann conditions result in approximately an order of</span>
    <span class="c">! magnitude lower accuracy. When using the Jacobian block for</span>
    <span class="c">! multiplation, the type of the boundary does not matter; the</span>
    <span class="c">! value at the boundary in the result will be set to 0 or to</span>
    <span class="c">! values produced by an optional user-provided function. When</span>
    <span class="c">! using the `solve_for` method, the tridiagonal matrix will be</span>
    <span class="c">! altered in the specified locations to reflect the correct</span>
    <span class="c">! boundary conditions. This effectively mimics the sorts of</span>
    <span class="c">! Jacobian rows typically produced by boundary conditions.</span>
    <span class="c">!</span>
    <span class="k">private</span>
<span class="k">    </span><span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">direction</span>
      <span class="c">!! The direction in which any derivatives are taken.</span>
    <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">extra_derivative</span> <span class="o">=</span> <span class="n">no_extra_derivative</span>
      <span class="c">!! The direction in which to apply a differentiation on the</span>
      <span class="c">!! right-hand-side of the Jacobian block operator. Defaults</span>
      <span class="c">!! none.</span>
    <span class="k">class</span><span class="p">(</span><span class="n">scalar_field</span><span class="p">),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">contents</span>
      <span class="c">!! The value, \(A\), to which the Jacobian block operation is</span>
      <span class="c">!! beiing applied.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">coef</span> <span class="o">=</span> <span class="mf">1._r8</span>
      <span class="c">!! Optional coefficient by which the the \(\partial F/\partial x</span>
      <span class="c">!! \) term in the operator will be multiplied.</span>
    <span class="k">procedure</span><span class="p">(</span><span class="n">jacobian_block_bounds</span><span class="p">),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">nopass</span>  <span class="kd">::</span> <span class="p">&amp;</span>
                                           <span class="n">get_boundaries</span>
      <span class="c">!! A subroutine which determines the expected boundary conditions</span>
      <span class="c">!! (and their location in the raw array) for the solution of the</span>
      <span class="c">!! Jacobian block.</span>
    <span class="k">class</span><span class="p">(</span><span class="n">scalar_field</span><span class="p">),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">derivative</span>
      <span class="c">!! The cached derivative of `contents`</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">diagonal</span>
      <span class="c">!! The diagonal of the tridiagonal matrix representation of this</span>
      <span class="c">!! block.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">super_diagonal</span>
      <span class="c">!! The super-diagonal of the tridiagonal matrix representation</span>
      <span class="c">!! of this block.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sub_diagonal</span>
      <span class="c">!! The sub-diagonal of the tridiagonal matrix representation of</span>
      <span class="c">!! this block.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">l_multipliers</span>
      <span class="c">!! Multipliers defining the L matrix in the LU factorisation of</span>
      <span class="c">!! the tridiagonal matrix representation of this block.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">u_diagonal</span>
      <span class="c">!! The diagonal of the U matrix in the LU factorisation of</span>
      <span class="c">!! the tridiagonal matrix representation of this block.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">u_superdiagonal1</span>
      <span class="c">!! The first superdiagonal of the U matrix in the LU</span>
      <span class="c">!! factorisation of the tridiagonal matrix representation of</span>
      <span class="c">!! this block.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">u_superdiagonal2</span>
      <span class="c">!! The second superdiagonal of the U matrix in the LU</span>
      <span class="c">!! factorisation of the tridiagonal matrix representation of</span>
      <span class="c">!! this block.</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>  <span class="kd">::</span> <span class="n">pivots</span>
      <span class="c">!! Pivot indicies from the LU factorisation of the tridiagonal</span>
      <span class="c">!! matrix representation of this block.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">boundary_vals</span>
      <span class="c">!! Expected boundary values for the solution to the Jacobian</span>
      <span class="c">!! block.</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>  <span class="kd">::</span> <span class="n">boundary_locs</span>
      <span class="c">!! Locations in the raw arrays which are used to specify</span>
      <span class="c">!! boundary conditions.</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>  <span class="kd">::</span> <span class="n">boundary_types</span>
      <span class="c">!! The types of boundary conditions, specified using the</span>
      <span class="c">!! parameters found in [[boundary_types_mod]].</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">real_increment</span>
      <span class="c">!! A scalar value which is to be added to this Jacobian block</span>
      <span class="c">!! (i.e. to the diagonal).</span>
    <span class="k">class</span><span class="p">(</span><span class="n">scalar_field</span><span class="p">),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">field_increment</span>
      <span class="c">!! A scalar field which is to be added to this Jacobian block</span>
      <span class="c">!! (i.e. to the diagonal).</span>
    <span class="k">type</span><span class="p">(</span><span class="n">jacobian_block</span><span class="p">),</span> <span class="k">pointer</span>       <span class="kd">::</span> <span class="n">block_increment</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
      <span class="c">!! Another Jacobian block which is to be added to this one</span>
    <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">has_increment</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="c">!! Indicates whether or not there has been an increment added to</span>
      <span class="c">!! this block. If not, then 0. If a scalar real value has been</span>
      <span class="c">!! added, then 1. If a scalar value has been added, then 2.</span>
  <span class="k">contains</span>
<span class="k">    private</span>
<span class="k">    procedure</span> <span class="kd">::</span> <span class="n">jacobian_block_multiply</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">jacobian_block_add_real</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">jacobian_block_add_field</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">jacobian_block_add_block</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">jacobian_block_assign</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_tridiag</span> <span class="o">=&gt;</span> <span class="n">jacobian_block_get_tridiag</span>
    <span class="k">generic</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">jacobian_block_multiply</span>
    <span class="k">generic</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">jacobian_block_add_real</span><span class="p">,</span>  <span class="p">&amp;</span>
                                      <span class="n">jacobian_block_add_field</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">jacobian_block_add_block</span>
    <span class="k">generic</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">assignment</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">jacobian_block_assign</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">solve_for</span> <span class="o">=&gt;</span> <span class="n">jacobian_block_solve</span>
  <span class="k">end type </span><span class="n">jacobian_block</span>
</pre></div>

    </section>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ISOFT was developed by Chris MacMackin</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="../js/MathJax-config/mj-config.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>