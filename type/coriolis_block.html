<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Ice Shelf/Ocean Fluid- and Thermodynamics: a suite of tools and programs to use for simulating the evolution of ice shelves interacting with the ocean.">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>coriolis_block &ndash; ISOFT </title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ISOFT </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>coriolis_block
    <small>Derived Type</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     <li><i class="fa fa-pencil"></i> Chris MacMackin</li>
     
     
    <li><i class="fa fa-calendar-o"></i> January 2017</li>
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="<p> 4.2% of total for derived types.</p>Including implementation: 142 statements,  2.3% of total for derived types.">29 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/coriolis_block.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/coriolis_block.f90.html'>coriolis_block.F90</a></li>
    
     <li><a href='../module/coriolis_block_mod.html'>coriolis_block_mod</a></li>
    
  
     <li class="active">coriolis_block</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-d_r">D_r</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-d_i">D_i</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-emdxvinv_r">emDxVinv_r</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-emdxvinv_i">emDxVinv_i</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-edx_r">eDx_r</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-edx_i">eDx_i</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-v_r">V_r</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-v_i">V_i</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-integrator">integrator</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-vel_bound_loc">vel_bound_loc</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-dvel_bound_loc">dvel_bound_loc</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-integrate_bound">integrate_bound</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-xbounds">xbounds</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-bound_matrix">bound_matrix</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-bound_matrix_scaled">bound_matrix_scaled</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-factored_matrix">factored_matrix</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-pivots%7E2">pivots</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-r_scales">r_scales</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-c_scales">c_scales</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-equed">equed</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-int">int</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#cons-0">Constructor</a></h3></div>
  <div id="cons-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../type/coriolis_block.html#interface-coriolis_block">coriolis_block</a>
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-0">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/coriolis_block.html#boundprocedure-solve_for%7E4">solve_for</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#boundprocedure-assign%7E3">assign</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#boundprocedure-assignment%28%3D%29%7E4">assignment(=)</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../type/coriolis_block.html#src">coriolis_block</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>type, public :: coriolis_block</h2>
    <p>A data type representing a matrix operator for the momentum
 components of the linear parts plume equations, with the
 Coriolis force. It can be useful when preconditioning a the
 plume solver. It is inherently 1-D in its implementation, but
 has a transverse velocity component.</p>
<p>This type solves the linear, coupled, differential equation 
 <script type="math/tex; mode=display"> \frac{d}{dx} \bm{Y} = \bm{A}\bm{Y} + \bm{F} </script>
 where <script type="math/tex"> \bm{Y} = [U, V, U', V']^{T} </script>,
 [ \bm{A} = \begin{bmatrix}
 0        &amp; 0         &amp; 1 &amp; 0 \    ! 0        &amp; 0         &amp; 0 &amp; 1 \    ! 0        &amp; -\Phi/\nu &amp; 0 &amp; 0 \    ! \Phi/\nu &amp; 0         &amp; 0 &amp; 0</p>
    <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Inherits</h3>
      </div>
      <div class="panel-body">
    <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: type~~coriolis_block~~InheritsGraph Pages: 1 -->
<svg id="typecoriolis_blockInheritsGraph" width="398pt" height="74pt"
 viewBox="0.00 0.00 398.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="type~~coriolis_block~~InheritsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>type~~coriolis_block~~InheritsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-70 394,-70 394,4 -4,4"/>
<!-- type~coriolis_block -->
<g id="type~~coriolis_block~~InheritsGraph_node1" class="node"><title>type~coriolis_block</title>
<polygon fill="none" stroke="black" points="390,-45 314,-45 314,-21 390,-21 390,-45"/>
<text text-anchor="middle" x="352" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">coriolis_block</text>
</g>
<!-- type~pseudospec_block -->
<g id="type~~coriolis_block~~InheritsGraph_node2" class="node"><title>type~pseudospec_block</title>
<g id="a_type~~coriolis_block~~InheritsGraph_node2"><a xlink:href=".././type/pseudospec_block.html" xlink:title="pseudospec_block">
<polygon fill="#5cb85c" stroke="#5cb85c" points="104.5,-66 3.5,-66 3.5,-42 104.5,-42 104.5,-66"/>
<text text-anchor="middle" x="54" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pseudospec_block</text>
</a>
</g>
</g>
<!-- type~coriolis_block&#45;&gt;type~pseudospec_block -->
<g id="type~~coriolis_block~~InheritsGraph_edge1" class="edge"><title>type~coriolis_block&#45;&gt;type~pseudospec_block</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M313.811,-35.6384C263.759,-39.1894 174.142,-45.5473 114.62,-49.7702"/>
<polygon fill="#000000" stroke="#000000" points="114.333,-46.2817 104.606,-50.4807 114.828,-53.2641 114.333,-46.2817"/>
<text text-anchor="middle" x="211" y="-50.4" font-family="Helvetica,sans-Serif" font-size="9.50">integrator</text>
</g>
<!-- cheb1d_scalar_field -->
<g id="type~~coriolis_block~~InheritsGraph_node3" class="node"><title>cheb1d_scalar_field</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="108,-24 0,-24 0,-0 108,-0 108,-24"/>
<text text-anchor="middle" x="54" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cheb1d_scalar_field</text>
</g>
<!-- type~coriolis_block&#45;&gt;cheb1d_scalar_field -->
<g id="type~~coriolis_block~~InheritsGraph_edge2" class="edge"><title>type~coriolis_block&#45;&gt;cheb1d_scalar_field</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M313.823,-25.5424C307.881,-24.5524 301.786,-23.6551 296,-23 235.97,-16.2039 167.078,-13.574 118.368,-12.5731"/>
<polygon fill="#000000" stroke="#000000" points="118.354,-9.07236 108.29,-12.3834 118.222,-16.0711 118.354,-9.07236"/>
<text text-anchor="middle" x="211" y="-25.4" font-family="Helvetica,sans-Serif" font-size="9.50">emDxVinv_r, emDxVinv_i, eDx_r, eDx_i</text>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="177pt" height="32pt"
 viewBox="0.00 0.00 177.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 173,-28 173,4 -4,4"/>
<!-- Type -->
<g id="node1" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="169.25,-24 72.75,-24 72.75,-0 169.25,-0 169.25,-24"/>
<text text-anchor="middle" x="121" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a derived type to the parent type which it
    extends. Dashed arrows point from a derived type to the other
    types it contains as a components, with a label listing the name(s) of
    said component(s).
    </p>
    </div></div></div></div>
      </div>
    </div>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Inherited by</h3>
      </div>
      <div class="panel-body">
     <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: type~~coriolis_block~~InheritedByGraph Pages: 1 -->
<svg id="typecoriolis_blockInheritedByGraph" width="246pt" height="32pt"
 viewBox="0.00 0.00 246.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="type~~coriolis_block~~InheritedByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>type~~coriolis_block~~InheritedByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 242,-28 242,4 -4,4"/>
<!-- type~coriolis_block -->
<g id="type~~coriolis_block~~InheritedByGraph_node1" class="node"><title>type~coriolis_block</title>
<polygon fill="none" stroke="black" points="76,-24 0,-24 0,-0 76,-0 76,-24"/>
<text text-anchor="middle" x="38" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">coriolis_block</text>
</g>
<!-- type~asym_plume -->
<g id="type~~coriolis_block~~InheritedByGraph_node2" class="node"><title>type~asym_plume</title>
<g id="a_type~~coriolis_block~~InheritedByGraph_node2"><a xlink:href=".././type/asym_plume.html" xlink:title="asym_plume">
<polygon fill="#5cb85c" stroke="#5cb85c" points="237.5,-24 164.5,-24 164.5,-0 237.5,-0 237.5,-24"/>
<text text-anchor="middle" x="201" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">asym_plume</text>
</a>
</g>
</g>
<!-- type~asym_plume&#45;&gt;type~coriolis_block -->
<g id="type~~coriolis_block~~InheritedByGraph_edge1" class="edge"><title>type~asym_plume&#45;&gt;type~coriolis_block</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M164.269,-12C141.329,-12 111.277,-12 86.3578,-12"/>
<polygon fill="#000000" stroke="#000000" points="86.0282,-8.5001 76.0282,-12 86.0282,-15.5001 86.0282,-8.5001"/>
<text text-anchor="middle" x="120" y="-14.4" font-family="Helvetica,sans-Serif" font-size="9.50">vel_precond</text>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="177pt" height="32pt"
 viewBox="0.00 0.00 177.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 173,-28 173,4 -4,4"/>
<!-- Type -->
<g id="node1" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="169.25,-24 72.75,-24 72.75,-0 169.25,-0 169.25,-24"/>
<text text-anchor="middle" x="121" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a derived type to the parent type which it
    extends. Dashed arrows point from a derived type to the other
    types it contains as a components, with a label listing the name(s) of
    said component(s).
    </p>
    </div></div></div></div>
      </div>
    </div>
    
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-d_r">D_r</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-d_i">D_i</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-emdxvinv_r">emDxVinv_r</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-emdxvinv_i">emDxVinv_i</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-edx_r">eDx_r</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-edx_i">eDx_i</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-v_r">V_r</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-v_i">V_i</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-integrator">integrator</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-vel_bound_loc">vel_bound_loc</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-dvel_bound_loc">dvel_bound_loc</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-integrate_bound">integrate_bound</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-xbounds">xbounds</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-bound_matrix">bound_matrix</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-bound_matrix_scaled">bound_matrix_scaled</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-factored_matrix">factored_matrix</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-pivots%7E2">pivots</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-r_scales">r_scales</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-c_scales">c_scales</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-equed">equed</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#variable-int">int</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#cons-1">Constructor</a></h3></div>
  <div id="cons-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../type/coriolis_block.html#interface-coriolis_block">coriolis_block</a>
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-1">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/coriolis_block.html#boundprocedure-solve_for%7E4">solve_for</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#boundprocedure-assign%7E3">assign</a>
      
      <a class="list-group-item" href="../type/coriolis_block.html#boundprocedure-assignment%28%3D%29%7E4">assignment(=)</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../type/coriolis_block.html#src">coriolis_block</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
    <h2>Components</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-d_r"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>D_r</strong></td><td></td><td></td><td><p>Real component of the diagonal matrix, <script type="math/tex">\bm{D}</script>, with only
 diagonal values stored</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-d_i"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>D_i</strong></td><td></td><td></td><td><p>Imaginary component of the diagonal matrix, <script type="math/tex">\bm{D}</script>, with
 only diagonal values stored</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-emdxvinv_r"></span>type(cheb1d_scalar_field),</td>
  
  <td>private,</td>
  <td>dimension(4,4)</td><td>::</td>
  <td><strong>emDxVinv_r</strong></td><td></td><td></td><td><p>Real component of <script type="math/tex">e^{-\bm{D}x}\bm{V}^{-1}</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-emdxvinv_i"></span>type(cheb1d_scalar_field),</td>
  
  <td>private,</td>
  <td>dimension(4,4)</td><td>::</td>
  <td><strong>emDxVinv_i</strong></td><td></td><td></td><td><p>Imaginary component of <script type="math/tex">e^{-\bm{D}x}\bm{V}^{-1}</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-edx_r"></span>type(cheb1d_scalar_field),</td>
  
  <td>private,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>eDx_r</strong></td><td></td><td></td><td><p>Real component of <script type="math/tex">e^{\bm{D}x}</script>, with only diagonal values
 stored</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-edx_i"></span>type(cheb1d_scalar_field),</td>
  
  <td>private,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>eDx_i</strong></td><td></td><td></td><td><p>Imaginary component of <script type="math/tex">e^{\bm{D}x}</script>, with only diagonal
 values stored</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v_r"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4,4)</td><td>::</td>
  <td><strong>V_r</strong></td><td></td><td></td><td><p>Real component of the change of basis matrix, <script type="math/tex">\bm{V}</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v_i"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4,4)</td><td>::</td>
  <td><strong>V_i</strong></td><td></td><td></td><td><p>Imaginary component of the change of basis matrix, <script type="math/tex">\bm{V}</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-integrator"></span>type(<a href='../type/pseudospec_block.html'>pseudospec_block</a>),</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>integrator</strong></td><td></td><td></td><td><p>A pseudospectral differentiation block which can be used to
 perform integration</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-vel_bound_loc"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>vel_bound_loc</strong></td><td></td><td></td><td><p>Location code for the velocity's boundary condition</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dvel_bound_loc"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>dvel_bound_loc</strong></td><td></td><td></td><td><p>Location code for the velocity derivative's boundary
 condition</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-integrate_bound"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>integrate_bound</strong></td><td></td><td></td><td><p>Location from which to perform the integration</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xbounds"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>xbounds</strong></td><td></td><td></td><td><p>Boundary location for each component of the solution vector</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-bound_matrix"></span>complex(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4,4)</td><td>::</td>
  <td><strong>bound_matrix</strong></td><td></td><td></td><td><p>Matrix for the system to solve in order to satisfy the
 boundary conditions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-bound_matrix_scaled"></span>complex(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4,4)</td><td>::</td>
  <td><strong>bound_matrix_scaled</strong></td><td></td><td></td><td><p>Matrix for the system to solve in order to satisfy the
 boundary conditions, which has been scaled by LAPACK95 
 to improve conditioning.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-factored_matrix"></span>complex(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4,4)</td><td>::</td>
  <td><strong>factored_matrix</strong></td><td></td><td></td><td><p>Factored matrix for the system to solve in order to satisfy
 the boundary conditions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pivots%7E2"></span>integer,</td>
  
  <td>private,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>pivots</strong></td><td></td><td></td><td><p>The pivots used in the factorisation of the matrix used to
 satisfy boundary conditions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-r_scales"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>r_scales</strong></td><td></td><td></td><td><p>Row scale factors from equilibrating the bound_matrix</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-c_scales"></span>real(kind=r8),</td>
  
  <td>private,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>c_scales</strong></td><td></td><td></td><td><p>Column scale factors from equilibrating the bound_matrix</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-equed"></span>character(len=1),</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>equed</strong></td><td></td><td></td><td><p>The method used to equilibrate bound_matrix</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-int"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>int</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
   <section>
   <h2>Constructor</h2>
     
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-coriolis_block"></span><h3>public interface <a href='../interface/coriolis_block.html'>coriolis_block</a>
    
  </h3></div>
  
  <ul class="list-group">
  
  
  
    <li class="list-group-item">
    
    
    <h3>
private function <a href='../proc/constructor%7E7.html'>constructor</a>(phi, nu, velbound, dvelbound, integrate_bound, template) result(this)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>January 2018</dd>
    
    
    
    
  </dl>



<p>Builds a Coriolis block which can be used to solve the inverse
 problem for the linear components of the plume momentum
 equations. The result can only be used with fields having the
 same grid as the template.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>phi</strong></td><td><p>The dimensionless coriolis parameter</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nu</strong></td><td><p>The dimensionless eddy diffusivity</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>velbound</strong></td><td><p>Location code for the velocity's boundary condition. 1
 indicates upper boundary, -1 indicates lower boundary.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dvelbound</strong></td><td><p>Location code for the velocity's boundary condition. 1
 indicates upper boundary, -1 indicates lower boundary.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>integrate_bound</strong></td><td><p>Location code for the boundary to perform integrations
 from. This should be the opposite boundary from where
 boundary data is stored.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(abstract_field),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>template</strong></td><td><p>A scalar field with the same grid as any fields passed as
 arguments to the <a href="../type/pseudospec_block.html#boundprocedure-solve_for">solve_for</a> method.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>type(<a href='../type/coriolis_block.html'>coriolis_block</a>)
  </small></h4>
  
    

    </li>
  
  
  </ul>
</div>

     
   </section>
   <br>
    
    
    
    
     
    <section>
    <h2>Type-Bound Procedures</h2>
    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-solve_for%7E4"></span><h3>procedure, public :: <strong>solve_for</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/solve_for.html'>solve_for</a>(this, velocity, velocity_dx)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>January 2018</dd>
    
    
    
    
  </dl>



<p>Inverts the linear portions of the plume momentum equation with
 the provided data. This is done by solving the linear ODE
 described in the documentation for the <a href="../type/coriolis_block.html">coriolis_block</a>
 type. The block object must first have been initialised using
 the constructor.</p><a href="../proc/solve_for.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/coriolis_block.html'>coriolis_block</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(vector_field),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>velocity</strong></td><td><p>On input, the velocity value being preconditioned. On output,
 the preconditioned velocity.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(vector_field),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>velocity_dx</strong></td><td><p>On input, the velocity derivative being preconditioned. On
 output, the preconditioned velocity derivative.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-assign%7E3"></span><h3>procedure, private :: <strong>assign</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/assign.html'>assign</a>(this, rhs)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>January 2017</dd>
    
    
    
    
  </dl>



<p>Safely assigns the value of one coriolis block to another.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/coriolis_block.html'>coriolis_block</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/coriolis_block.html'>coriolis_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td><p>The value being assigned</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-assignment%28%3D%29%7E4"></span><h3>generic, public :: <strong>assignment(=)</strong>  => <a href='../type/coriolis_block.html#boundprocedure-assign%7E3'>assign</a> 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
         
            
    
    <h3>
private subroutine <a href='../proc/assign.html'>assign</a>(this, rhs)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>January 2017</dd>
    
    
    
    
  </dl>



<p>Safely assigns the value of one coriolis block to another.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/coriolis_block.html'>coriolis_block</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/coriolis_block.html'>coriolis_block</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhs</strong></td><td><p>The value being assigned</p></td>
  
</tr>

</tbody>
</table>

      
    
    

         
      
      </li>
    
  </ul>
</div>

    
    </section>
    
    
    
    <section>
    <h3><span class="anchor" id="src"></span>Source Code</h3>
    <div class="highlight"><pre><span></span>  <span class="k">type</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">coriolis_block</span>
    <span class="c">!* Author: Chris MacMackin</span>
    <span class="c">!  Date: January 2017</span>
    <span class="c">!</span>
    <span class="c">! A data type representing a matrix operator for the momentum</span>
    <span class="c">! components of the linear parts plume equations, with the</span>
    <span class="c">! Coriolis force. It can be useful when preconditioning a the</span>
    <span class="c">! plume solver. It is inherently 1-D in its implementation, but</span>
    <span class="c">! has a transverse velocity component.</span>
    <span class="c">!</span>
    <span class="c">! This type solves the linear, coupled, differential equation </span>
    <span class="c">! \[ \frac{d}{dx} \bm{Y} = \bm{A}\bm{Y} + \bm{F} \]</span>
    <span class="c">! where \( \bm{Y} = [U, V, U&#39;, V&#39;]^{T} \),</span>
    <span class="c">! \[ \bm{A} = \begin{bmatrix}</span>
    <span class="c">! 0        &amp; 0         &amp; 1 &amp; 0 \\</span>
    <span class="c">! 0        &amp; 0         &amp; 0 &amp; 1 \\</span>
    <span class="c">! 0        &amp; -\Phi/\nu &amp; 0 &amp; 0 \\</span>
    <span class="c">! \Phi/\nu &amp; 0         &amp; 0 &amp; 0</span>
    <span class="c">! \end{bmatrix},</span>
    <span class="c">! \]</span>
    <span class="c">! and \( \bm{F} \) is the input value to which this block is </span>
    <span class="c">! applied in the preconditioner. \(\Phi\) is the dimensionless</span>
    <span class="c">! coriolis parameter, while \(\nu\) is the eddy viscosity.</span>
    <span class="c">!</span>
    <span class="c">! The matrix \(\bm{A}\) can be diagonalised by factoring it such</span>
    <span class="c">! that \(\bm{A} = \bm{V}\bm{D}\bm{V}^{-1}\), where \(\bm{V}\) is a</span>
    <span class="c">! change of basis matrix with columns made up of the eigenvectors </span>
    <span class="c">! of \(\bm{A}\) and \(\bm{D}\) is a diagonal matrix made up of</span>
    <span class="c">! the corresponding eigenvalues. These have the values</span>
    <span class="c">! \[ \bm{V} = \begin{bmatrix}</span>
    <span class="c">! \tfrac{-1-i}{\alpha} &amp; \tfrac{-1+i}{\alpha} &amp; \tfrac{1-i}{\alpha} &amp; \tfrac{1+i}{\alpha} \\</span>
    <span class="c">! \tfrac{-1+i}{\alpha} &amp; \tfrac{-1-i}{\alpha} &amp; \tfrac{1+i}{\alpha} &amp; \tfrac{1-i}{\alpha} \\</span>
    <span class="c">! i                    &amp; -i                   &amp; -i                  &amp; i                   \\</span>
    <span class="c">! 1                    &amp; 1                    &amp; 1                   &amp; 1</span>
    <span class="c">! \end{bmatrix},</span>
    <span class="c">! \]</span>
    <span class="c">! \[ \bm{D} = \beta\begin{bmatrix}</span>
    <span class="c">! -1-i &amp; 0    &amp; 0   &amp; 0   \\</span>
    <span class="c">! 0    &amp; -1+i &amp;     &amp; 0   \\</span>
    <span class="c">! 0    &amp; 0    &amp; 1-i &amp; 0   \\</span>
    <span class="c">! 0    &amp; 0    &amp; 0   &amp; 1+i</span>
    <span class="c">! \end{bmatrix},</span>
    <span class="c">! \]</span>
    <span class="c">! \[ \bm{V}^{-1} = \frac{1}{4}\begin{bmatrix}</span>
    <span class="c">! (-1+i)\beta &amp; -(1+i)\beta &amp; -i &amp; 1 \\</span>
    <span class="c">! (-1-i)\beta &amp; -(1-i)\beta &amp; i  &amp; 1 \\</span>
    <span class="c">! (1+i)\beta  &amp; (1-i)\beta  &amp; i  &amp; 1 \\</span>
    <span class="c">! (1-i)\beta  &amp; (1+i)\beta  &amp; -i &amp; 1</span>
    <span class="c">! \end{bmatrix},</span>
    <span class="c">! \]</span>
    <span class="c">! \[ \alpha = \sqrt{\frac{2\Phi}{\nu}}, \quad \beta = \sqrt{\frac{\Phi}{2\nu}}. \]</span>
    <span class="c">! It can be shown that the solution to the differential equation is</span>
    <span class="c">! \[ \bm{Y} = \bm{V}\left(e^{\bm{D}x}\bm{B} + </span>
    <span class="c">!    e^{\bm{D}x}\int_0^{x}e^{\bm{D}x&#39;}\bm{V}^{-1}\bm{F}dx&#39; \right),\]</span>
    <span class="c">! where \(\bm{B}\in\mathbb{R}^{4}\) is a vector chosen to satisfy</span>
    <span class="c">! the boundary conditions on the system. It can be found by solving a</span>
    <span class="c">! 4×4 linear system.</span>
    <span class="c">!</span>
    <span class="c">! This type inherits </span>
    <span class="c">!</span>
    <span class="k">private</span>
<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">D_r</span>
      <span class="c">!! Real component of the diagonal matrix, \(\bm{D}\), with only</span>
      <span class="c">!! diagonal values stored</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">D_i</span>
      <span class="c">!! Imaginary component of the diagonal matrix, \(\bm{D}\), with</span>
      <span class="c">!! only diagonal values stored</span>
    <span class="k">type</span><span class="p">(</span><span class="n">cheb1d_scalar_field</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">emDxVinv_r</span>
      <span class="c">!! Real component of \(e^{-\bm{D}x}\bm{V}^{-1}\)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">cheb1d_scalar_field</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">emDxVinv_i</span>
      <span class="c">!! Imaginary component of \(e^{-\bm{D}x}\bm{V}^{-1}\)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">cheb1d_scalar_field</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eDx_r</span>
      <span class="c">!! Real component of \(e^{\bm{D}x}\), with only diagonal values</span>
      <span class="c">!! stored</span>
    <span class="k">type</span><span class="p">(</span><span class="n">cheb1d_scalar_field</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eDx_i</span>
      <span class="c">!! Imaginary component of \(e^{\bm{D}x}\), with only diagonal</span>
      <span class="c">!! values stored</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V_r</span>
      <span class="c">!! Real component of the change of basis matrix, \(\bm{V}\)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V_i</span>
      <span class="c">!! Imaginary component of the change of basis matrix, \(\bm{V}\)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pseudospec_block</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">integrator</span>
      <span class="c">!! A pseudospectral differentiation block which can be used to</span>
      <span class="c">!! perform integration</span>
    <span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">vel_bound_loc</span>
      <span class="c">!! Location code for the velocity&#39;s boundary condition</span>
    <span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">dvel_bound_loc</span>
      <span class="c">!! Location code for the velocity derivative&#39;s boundary</span>
      <span class="c">!! condition</span>
    <span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">integrate_bound</span>
      <span class="c">!! Location from which to perform the integration</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">xbounds</span>
      <span class="c">!! Boundary location for each component of the solution vector</span>
    <span class="kt">complex</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bound_matrix</span>
      <span class="c">!! Matrix for the system to solve in order to satisfy the</span>
      <span class="c">!! boundary conditions</span>
    <span class="kt">complex</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bound_matrix_scaled</span>
      <span class="c">!! Matrix for the system to solve in order to satisfy the</span>
      <span class="c">!! boundary conditions, which has been scaled by LAPACK95 </span>
      <span class="c">!! to improve conditioning.</span>
    <span class="kt">complex</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">factored_matrix</span>
      <span class="c">!! Factored matrix for the system to solve in order to satisfy</span>
      <span class="c">!! the boundary conditions</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">pivots</span>
      <span class="c">!! The pivots used in the factorisation of the matrix used to</span>
      <span class="c">!! satisfy boundary conditions</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">r_scales</span>
      <span class="c">!! Row scale factors from equilibrating the bound_matrix</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">c_scales</span>
      <span class="c">!! Column scale factors from equilibrating the bound_matrix</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">equed</span>
      <span class="c">!! The method used to equilibrate bound_matrix</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="nb">int</span>
<span class="nb">  </span><span class="k">contains</span>
<span class="k">    private</span>
<span class="k">    procedure</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">solve_for</span>
    <span class="k">procedure</span>         <span class="kd">::</span> <span class="k">assign</span>
<span class="k">    generic</span><span class="p">,</span> <span class="k">public</span>   <span class="kd">::</span> <span class="n">assignment</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">assign</span>
<span class="k">  end type </span><span class="n">coriolis_block</span>
</pre></div>

    </section>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ISOFT was developed by Chris MacMackin</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="../js/MathJax-config/mj-config.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>