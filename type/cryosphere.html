<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Ice Shelf/Ocean Fluid- and Thermodynamics: a suite of tools and programs to use for simulating the evolution of ice shelves interacting with the ocean.">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>cryosphere &ndash; ISOFT </title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ISOFT </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>cryosphere
    <small>Derived Type</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     <li><i class="fa fa-pencil"></i> Christopher MacMackin</li>
     
     
    <li><i class="fa fa-calendar-o"></i> April 2016</li>
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="<p> 2.9% of total for derived types.</p>Including implementation: 307 statements,  5.0% of total for derived types.">22 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/cryosphere.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/cryosphere.f90.html'>cryosphere.F90</a></li>
    
     <li><a href='../module/cryosphere_mod.html'>cryosphere_mod</a></li>
    
  
     <li class="active">cryosphere</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-ice">ice</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-sub_ice">sub_ice</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-time%7E3">time</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-first_integration">first_integration</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-dt_factor">dt_factor</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-min_dt_factor">min_dt_factor</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-performing_time_step">performing_time_step</a>
      
    </div>
  </div>
</div>


















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-0">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-initialise%7E3">initialise</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-time_step%7E2">time_step</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-reduce_time_step">reduce_time_step</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-increase_time_step">increase_time_step</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-state_vector%7E8">state_vector</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-integrate%7E2">integrate</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-read_data%7E4">read_data</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-read_ice">read_ice</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-read_sub_ice">read_sub_ice</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-write_data%7E4">write_data</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-get_time">get_time</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../type/cryosphere.html#src">cryosphere</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>type, public :: cryosphere</h2>
    <p>A data structure representing glaciers, either as ice shelves or
 (eventually) ice sheets. It will allow coupled systems of
 glaciers as well as different basal couplings with the ocean or
 ground. This type is a subclass of the
 <a href="https://github.com/Fortran-FOSS-Programmers/FOODIE">FOODIE</a>
 <a href="http://fortran-foss-programmers.github.io/FOODIE/type/integrand.html">integrand</a>,
 allowing it to take advantage of that set of integration
 libraries for evolution in time.</p>
    <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Inherits</h3>
      </div>
      <div class="panel-body">
    <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: type~~cryosphere~~InheritsGraph Pages: 1 -->
<svg id="typecryosphereInheritsGraph" width="224pt" height="74pt"
 viewBox="0.00 0.00 224.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="type~~cryosphere~~InheritsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>type~~cryosphere~~InheritsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-70 220,-70 220,4 -4,4"/>
<!-- type~cryosphere -->
<g id="type~~cryosphere~~InheritsGraph_node1" class="node"><title>type~cryosphere</title>
<polygon fill="none" stroke="black" points="216,-45 150,-45 150,-21 216,-21 216,-45"/>
<text text-anchor="middle" x="183" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">cryosphere</text>
</g>
<!-- type~glacier -->
<g id="type~~cryosphere~~InheritsGraph_node2" class="node"><title>type~glacier</title>
<g id="a_type~~cryosphere~~InheritsGraph_node2"><a xlink:href=".././type/glacier.html" xlink:title="glacier">
<polygon fill="#5cb85c" stroke="#5cb85c" points="67,-66 13,-66 13,-42 67,-42 67,-66"/>
<text text-anchor="middle" x="40" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">glacier</text>
</a>
</g>
</g>
<!-- type~cryosphere&#45;&gt;type~glacier -->
<g id="type~~cryosphere~~InheritsGraph_edge1" class="edge"><title>type~cryosphere&#45;&gt;type~glacier</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M149.652,-37.8178C128.034,-41.0376 99.5664,-45.2773 77.1941,-48.6094"/>
<polygon fill="#000000" stroke="#000000" points="76.45,-45.1815 67.0747,-50.1165 77.4813,-52.1051 76.45,-45.1815"/>
<text text-anchor="middle" x="115" y="-47.4" font-family="Helvetica,sans-Serif" font-size="9.50">ice</text>
</g>
<!-- type~basal_surface -->
<g id="type~~cryosphere~~InheritsGraph_node3" class="node"><title>type~basal_surface</title>
<g id="a_type~~cryosphere~~InheritsGraph_node3"><a xlink:href=".././type/basal_surface.html" xlink:title="basal_surface">
<polygon fill="#5cb85c" stroke="#5cb85c" points="79.5,-24 0.5,-24 0.5,-0 79.5,-0 79.5,-24"/>
<text text-anchor="middle" x="40" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">basal_surface</text>
</a>
</g>
</g>
<!-- type~cryosphere&#45;&gt;type~basal_surface -->
<g id="type~~cryosphere~~InheritsGraph_edge2" class="edge"><title>type~cryosphere&#45;&gt;type~basal_surface</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M149.652,-28.1822C131.927,-25.5424 109.599,-22.2169 89.8004,-19.2681"/>
<polygon fill="#000000" stroke="#000000" points="90.1219,-15.7775 79.7154,-17.7661 89.0907,-22.7011 90.1219,-15.7775"/>
<text text-anchor="middle" x="115" y="-26.4" font-family="Helvetica,sans-Serif" font-size="9.50">sub_ice</text>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="177pt" height="32pt"
 viewBox="0.00 0.00 177.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 173,-28 173,4 -4,4"/>
<!-- Type -->
<g id="node1" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="169.25,-24 72.75,-24 72.75,-0 169.25,-0 169.25,-24"/>
<text text-anchor="middle" x="121" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a derived type to the parent type which it
    extends. Dashed arrows point from a derived type to the other
    types it contains as a components, with a label listing the name(s) of
    said component(s).
    </p>
    </div></div></div></div>
      </div>
    </div>
    
    
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-ice">ice</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-sub_ice">sub_ice</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-time%7E3">time</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-first_integration">first_integration</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-dt_factor">dt_factor</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-min_dt_factor">min_dt_factor</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#variable-performing_time_step">performing_time_step</a>
      
    </div>
  </div>
</div>


















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-1">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-initialise%7E3">initialise</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-time_step%7E2">time_step</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-reduce_time_step">reduce_time_step</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-increase_time_step">increase_time_step</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-state_vector%7E8">state_vector</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-integrate%7E2">integrate</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-read_data%7E4">read_data</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-read_ice">read_ice</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-read_sub_ice">read_sub_ice</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-write_data%7E4">write_data</a>
      
      <a class="list-group-item" href="../type/cryosphere.html#boundprocedure-get_time">get_time</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../type/cryosphere.html#src">cryosphere</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
    <h2>Components</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ice"></span>class(<a href='../type/glacier.html'>glacier</a>),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>ice</strong></td><td></td><td></td><td><p>A model for the ice shelf or ice sheet</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-sub_ice"></span>class(<a href='../type/basal_surface.html'>basal_surface</a>),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>sub_ice</strong></td><td></td><td></td><td><p>A model for the ground or ocean underneath the ice</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-time%7E3"></span>real(kind=r8),</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>time</strong></td><td></td><td></td><td><p>The time in the simulation</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-first_integration"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>first_integration</strong></td><td></td><td></td><td><p>Indicates whether the cryosphere has been integrated before
 or not.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt_factor"></span>real(kind=r8),</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>dt_factor</strong></td><td> =</td><td>1.0_r8</td><td><p>A factor by which to reduce the time step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-min_dt_factor"></span>real(kind=r8),</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>min_dt_factor</strong></td><td> =</td><td>1e-3_r8</td><td><p>The smallest time step reduction to allow</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-performing_time_step"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>performing_time_step</strong></td><td></td><td></td><td><p>True if in the process of trying to get a time-step to
 successfully integrate.</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    
    
     
    <section>
    <h2>Type-Bound Procedures</h2>
    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-initialise%7E3"></span><h3>procedure, public :: <strong>initialise</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/initialise.html'>initialise</a>(this, ice, sub_ice)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Christopher MacMackin</dd>
    
    
    <dt>Date</dt><dd>November 2016</dd>
    
    
    
    
  </dl>



<p>Initialise a cryosphere object from the provided
 components. This object will model the evolution of a
 glacier/ice shelf/ice sheet and its surroundings.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/glacier.html'>glacier</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>ice</strong></td><td><p>An object modelling the ice sheet or shelf component of this
 system. Will be deallocated on return.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/basal_surface.html'>basal_surface</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>sub_ice</strong></td><td><p>An object modelling the component of this system beneath the
 ice. Will be deallocated on return.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-time_step%7E2"></span><h3>procedure, public :: <strong>time_step</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private function <a href='../proc/time_step.html'>time_step</a>(this)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2016</dd>
    
    
    
    
  </dl>



<p>Calculates an appropriate time step with which to integrate the
 cryosphere so as not to cause numerical instability.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=r8)
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-reduce_time_step"></span><h3>procedure, public :: <strong>reduce_time_step</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/reduce_time_step.html'>reduce_time_step</a>(this)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Christopher MacMackin</dd>
    
    
    <dt>Date</dt><dd>April 2017</dd>
    
    
    
    
  </dl>



<p>Reuces the time step by a factor of 2, unless doing so would
 take it below the minimum value.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-increase_time_step"></span><h3>procedure, public :: <strong>increase_time_step</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/increase_time_step.html'>increase_time_step</a>(this)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Christopher MacMackin</dd>
    
    
    <dt>Date</dt><dd>April 2017</dd>
    
    
    
    
  </dl>



<p>Increases the time step by a factor of 2, unless doing so would
 take it above the maximum.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-state_vector%7E8"></span><h3>procedure, public :: <strong>state_vector</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private function <a href='../proc/state_vector.html'>state_vector</a>(this)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>April 2017</dd>
    
    
    
    
  </dl>



<p>Returns the state vector for the current state of the
 cryosphere. This takes the form of a 1D array. This routine is
 mainly useful for unit-testing.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=r8),
  dimension(:), allocatable</small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-integrate%7E2"></span><h3>procedure, public :: <strong>integrate</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/integrate.html'>integrate</a>(this, time)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Christopher MacMackin</dd>
    
    
    <dt>Date</dt><dd>April 2016</dd>
    
    
    
    
  </dl>



<p>Integrates the cryosphere forward until the specified <code>time</code> is
 reached.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>time</strong></td><td><p>The time to which to integrate the cryosphere</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-read_data%7E4"></span><h3>procedure, public :: <strong>read_data</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/read_data.html'>read_data</a>(this, infile, set_time)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Christopher MacMackin</dd>
    
    
    <dt>Date</dt><dd>April 2017</dd>
    
    
    
    
  </dl>



<p>Reads the data describing the cryosphere from an HDF5 file on
 the disc. <code>h5open_f</code> must have been called once prior to using
 this method. After the method has been used, <code>h5close_f</code> must be
 called once before the end of the program.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>infile</strong></td><td><p>The file from which to read the data describing the state of the 
 cryosphere</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>set_time</strong></td><td><p>If present and <code>.true.</code> then set the simulation time of the
 cryosphere to be the same as that in the HDF file. Otherwise,
 leave it unchanged.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-read_ice"></span><h3>procedure, public :: <strong>read_ice</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/read_ice.html'>read_ice</a>(this, infile, set_time)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Christopher MacMackin</dd>
    
    
    <dt>Date</dt><dd>December 2017</dd>
    
    
    
    
  </dl>



<p>Reads the data describing the ice component of the cryosphere
 from an HDF5 file on the disc. Data on anything below the ice is
 ignored. <code>h5open_f</code> must have been called once prior to using
 this method. After the method has been used, <code>h5close_f</code> must be
 called once before the end of the program.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>infile</strong></td><td><p>The file from which to read the data describing the state of the 
 cryosphere</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>set_time</strong></td><td><p>If present and <code>.true.</code> then set the simulation time of the
 cryosphere to be the same as that in the HDF file. Otherwise,
 leave it unchanged.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-read_sub_ice"></span><h3>procedure, public :: <strong>read_sub_ice</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/read_sub_ice.html'>read_sub_ice</a>(this, infile, set_time)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Christopher MacMackin</dd>
    
    
    <dt>Date</dt><dd>April 2017</dd>
    
    
    
    
  </dl>



<p>Reads the data describing the part of the cryosphere beneath the
 ice from an HDF5 file on the disc. Data on the ice itself is
 ignored. <code>h5open_f</code> must have been called once prior to using
 this method. After the method has been used, <code>h5close_f</code> must be
 called once before the end of the program.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>infile</strong></td><td><p>The file from which to read the data describing the state of the 
 cryosphere</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>set_time</strong></td><td><p>If present and <code>.true.</code> then set the simulation time of the
 cryosphere to be the same as that in the HDF file. Otherwise,
 leave it unchanged.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-write_data%7E4"></span><h3>procedure, public :: <strong>write_data</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine <a href='../proc/write_data.html'>write_data</a>(this, outfile)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Christopher MacMackin</dd>
    
    
    <dt>Date</dt><dd>April 2016</dd>
    
    
    
    
  </dl>



<p>Writes the data describing the cryosphere to the disc as an HDF5
 file. <code>h5open_f</code> must have been called once prior to using this
 method. After the method has been used, <code>h5close_f</code> must be
 called once before the end of the program.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>outfile</strong></td><td><p>The file to which to write the data describing the state of the 
 cryosphere</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_time"></span><h3>procedure, public :: <strong>get_time</strong>  
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private pure function <a href='../proc/get_time.html'>get_time</a>(this)
    
    
   
</h3>
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>April 2017</dd>
    
    
    
    
  </dl>



<p>Returns the current time of the cryosphere system.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/cryosphere.html'>cryosphere</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=r8)
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
    </section>
    
    
    
    <section>
    <h3><span class="anchor" id="src"></span>Source Code</h3>
    <div class="highlight"><pre><span></span>  <span class="k">type</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">cryosphere</span>
    <span class="c">!* Author: Christopher MacMackin</span>
    <span class="c">!  Date: April 2016</span>
    <span class="c">!</span>
    <span class="c">! A data structure representing glaciers, either as ice shelves or</span>
    <span class="c">! (eventually) ice sheets. It will allow coupled systems of</span>
    <span class="c">! glaciers as well as different basal couplings with the ocean or</span>
    <span class="c">! ground. This type is a subclass of the</span>
    <span class="c">! [FOODIE](https://github.com/Fortran-FOSS-Programmers/FOODIE)</span>
    <span class="c">! [integrand](http://fortran-foss-programmers.github.io/FOODIE/type/integrand.html),</span>
    <span class="c">! allowing it to take advantage of that set of integration</span>
    <span class="c">! libraries for evolution in time.</span>
    <span class="c">!</span>
    <span class="k">private</span>
<span class="k">    class</span><span class="p">(</span><span class="n">glacier</span><span class="p">),</span> <span class="k">allocatable</span>       <span class="kd">::</span> <span class="n">ice</span>
      <span class="c">!! A model for the ice shelf or ice sheet</span>
    <span class="k">class</span><span class="p">(</span><span class="n">basal_surface</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sub_ice</span>
      <span class="c">!! A model for the ground or ocean underneath the ice</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                          <span class="kd">::</span> <span class="nb">time</span> 
      <span class="c">!! The time in the simulation</span>
    <span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">first_integration</span>
      <span class="c">!! Indicates whether the cryosphere has been integrated before</span>
      <span class="c">!! or not.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">dt_factor</span> <span class="o">=</span> <span class="mf">1.0_r8</span>
      <span class="c">!! A factor by which to reduce the time step</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">min_dt_factor</span> <span class="o">=</span> <span class="err">1</span><span class="n">e</span><span class="o">-</span><span class="mi">3_r8</span>
      <span class="c">!! The smallest time step reduction to allow</span>
    <span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">performing_time_step</span>
      <span class="c">!! True if in the process of trying to get a time-step to</span>
      <span class="c">!! successfully integrate.</span>
  <span class="k">contains</span>
<span class="k">    procedure</span> <span class="kd">::</span> <span class="n">initialise</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">time_step</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">reduce_time_step</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">increase_time_step</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">state_vector</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">integrate</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">read_data</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">read_ice</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">read_sub_ice</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">write_data</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_time</span>
  <span class="k">end type </span><span class="n">cryosphere</span>
</pre></div>

    </section>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ISOFT was developed by Chris MacMackin</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="../js/MathJax-config/mj-config.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>