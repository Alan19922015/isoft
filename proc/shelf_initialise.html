<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Ice Shelf/Ocean Fluid- and Thermodynamics: a suite of tools and programs to use for simulating the evolution of ice shelves interacting with the ocean.">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>shelf_initialise &ndash; ISOFT</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ISOFT </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>shelf_initialise
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     <li><i class="fa fa-pencil"></i> Christopher MacMackin</li>
     
     
    <li><i class="fa fa-calendar-o"></i> April 2016</li>
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.8% of total for procedures.">88 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/ice_shelf.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/ice_shelf.f90.html'>ice_shelf.F90</a></li>
    
     <li><a href='../module/ice_shelf_mod.html'>ice_shelf_mod</a></li>
    
  
     <li class="active">shelf_initialise</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/shelf_initialise.html#src">shelf_initialise</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
private subroutine shelf_initialise(this, domain, resolution, thickness, velocity, temperature, viscosity_law, boundaries, lambda, chi, zeta, courant, max_dt, kappa, n_kappa)
    
    
   
</h2>
    
  


    
    <p>Initialises an <a href="../type/ice_shelf.html">ice_shelf</a> object with initial conditions provided
 by the arguments. At present only a 1D model is supported. If
 information is provided for higher dimensions then it will be ignored.</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-this%7E90"></span>class(<a href='../type/ice_shelf.html'>ice_shelf</a>),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-domain%7E3"></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:,:)</td><td>::</td>
  <td><strong>domain</strong></td><td><p>An array containing the upper and lower limits of the domain for
 the ice shelf. The first index represents the dimension for which
 the boundaries apply. If the second index is 1 then it corresponds
 to the lower bound. If the second index is 2 then it corresponds to
 the upper bound.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-resolution%7E3"></span>integer,</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>resolution</strong></td><td><p>The number of data points in each dimension.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-thickness%7E17"></span>procedure(<a href='../interface/thickness_func.html'>thickness_func</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>thickness</strong></td><td><p>A function which calculates the initial value of the thickness of 
 the ice shelf at a given location.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-velocity%7E17"></span>procedure(<a href='../interface/velocity_func%7E3.html'>velocity_func</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>velocity</strong></td><td><p>A function which calculates the initial value of the velocity 
 (vector) of the ice at a given location in an ice shelf.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-temperature%7E26"></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>temperature</strong></td><td><p>The temperature of the ice in the ice shelf.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-viscosity_law%7E3"></span>class(<a href='../type/abstract_viscosity.html'>abstract_viscosity</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>viscosity_law</strong></td><td><p>An object which calculates the viscosity of the ice. If not
 specified, then Glen's law will be used with $n=3$. Will be
 unallocated on return.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-boundaries%7E7"></span>class(<a href='../type/glacier_boundary.html'>glacier_boundary</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>boundaries</strong></td><td><p>An object specifying the boundary conditions for the ice
 shelf. Will be unallocated on return.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lambda%7E3"></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>lambda</strong></td><td><p>The dimensionless ratio 
 $\lambda \equiv \frac{\rho_0m_0x_0}{\rho_ih_0u_0}$.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-chi%7E5"></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>chi</strong></td><td><p>The dimensionless ratio
 $\chi \equiv \frac{\rho_igh_0x_x}{2\eta_0u_0}\left(1 -
 \frac{\rho_i}{\rho_0}\right)$.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-zeta%7E2"></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>zeta</strong></td><td><p>The dimensionless ratio $\zeta \equiv
 \frac{\rho_iu_0x_0}{\eta_0}$, corresponding to the Reynolds
 number. Currently this is unused and always treated as 0.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-courant%7E2"></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>courant</strong></td><td><p>The Courant number to use when calculating the time
 step. Defaults to 100. Too large a value will pose
 difficulties for the nonlinear solver, while too small a
 value can be numerically unstable. Typically, smaller values
 are needed for lower resolution.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-max_dt%7E2"></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>max_dt</strong></td><td><p>The maximum allowable time step. This defaults to <script type="math/tex">1\times
 10^{99}</script> (effectively no maximum).</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kappa%7E3"></span>procedure(<a href='../interface/kappa_init_func.html'>kappa_init_func</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>kappa</strong></td><td><p>A function which specifies the initial values of the Taylor
 coefficients describing the vertical distribution of internal
 reflectors within the ice. The initial conditions at the
 grounding line will provide the boundary conditions there
 throughout the simulation. If this parameter is not provided
 then these layers will not be included in the
 integration. Both this parameter and <code>n_kappa</code> must be
 specified for the calculation to take place.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n_kappa"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>n_kappa</strong></td><td><p>The number of Taylor coefficients used to describe internal
 reflectors. If not provided then these reflectors will not be
 included in the integration. Both this parameter and <code>kappa</code>
 must be specified for the calculation to take place.</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~shelf_initialise~~CallsGraph Pages: 1 -->
<svg id="procshelf_initialiseCallsGraph" width="234pt" height="74pt"
 viewBox="0.00 0.00 234.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~shelf_initialise~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>proc~~shelf_initialise~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-70 230,-70 230,4 -4,4"/>
<!-- proc~shelf_initialise -->
<g id="proc~~shelf_initialise~~CallsGraph_node1" class="node"><title>proc~shelf_initialise</title>
<polygon fill="none" stroke="black" points="79.5,-45 0.5,-45 0.5,-21 79.5,-21 79.5,-45"/>
<text text-anchor="middle" x="40" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">shelf_initialise</text>
</g>
<!-- cheb1d_scalar_field -->
<g id="proc~~shelf_initialise~~CallsGraph_node2" class="node"><title>cheb1d_scalar_field</title>
<polygon fill="#777777" stroke="#777777" points="225,-66 117,-66 117,-42 225,-42 225,-66"/>
<text text-anchor="middle" x="171" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cheb1d_scalar_field</text>
</g>
<!-- proc~shelf_initialise&#45;&gt;cheb1d_scalar_field -->
<g id="proc~~shelf_initialise~~CallsGraph_edge1" class="edge"><title>proc~shelf_initialise&#45;&gt;cheb1d_scalar_field</title>
<path fill="none" stroke="#000000" d="M79.7043,-39.3007C88.2064,-40.6848 97.4246,-42.1854 106.613,-43.6811"/>
<polygon fill="#000000" stroke="#000000" points="106.103,-47.1442 116.535,-45.2965 107.228,-40.2351 106.103,-47.1442"/>
</g>
<!-- cheb1d_vector_field -->
<g id="proc~~shelf_initialise~~CallsGraph_node3" class="node"><title>cheb1d_vector_field</title>
<polygon fill="#777777" stroke="#777777" points="225.5,-24 116.5,-24 116.5,-0 225.5,-0 225.5,-24"/>
<text text-anchor="middle" x="171" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cheb1d_vector_field</text>
</g>
<!-- proc~shelf_initialise&#45;&gt;cheb1d_vector_field -->
<g id="proc~~shelf_initialise~~CallsGraph_edge2" class="edge"><title>proc~shelf_initialise&#45;&gt;cheb1d_vector_field</title>
<path fill="none" stroke="#000000" d="M79.7043,-26.6993C88.0081,-25.3475 96.995,-23.8845 105.97,-22.4235"/>
<polygon fill="#000000" stroke="#000000" points="106.753,-25.8423 116.06,-20.7809 105.628,-18.9332 106.753,-25.8423"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/shelf_initialise.html#src">shelf_initialise</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">shelf_initialise</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">velocity</span><span class="p">,</span> <span class="p">&amp;</span>
                              <span class="n">temperature</span><span class="p">,</span> <span class="n">viscosity_law</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">,</span> <span class="n">lambda</span><span class="p">,</span> <span class="p">&amp;</span>
                              <span class="n">chi</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">courant</span><span class="p">,</span> <span class="n">max_dt</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">n_kappa</span><span class="p">)</span>
    <span class="c">!* Author: Christopher MacMackin</span>
    <span class="c">!  Date: April 2016</span>
    <span class="c">!</span>
    <span class="c">! Initialises an [[ice_shelf]] object with initial conditions provided</span>
    <span class="c">! by the arguments. At present only a 1D model is supported. If</span>
    <span class="c">! information is provided for higher dimensions then it will be ignored.</span>
    <span class="c">!</span>
    <span class="k">class</span><span class="p">(</span><span class="n">ice_shelf</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">this</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">domain</span>
      <span class="c">!! An array containing the upper and lower limits of the domain for</span>
      <span class="c">!! the ice shelf. The first index represents the dimension for which</span>
      <span class="c">!! the boundaries apply. If the second index is 1 then it corresponds</span>
      <span class="c">!! to the lower bound. If the second index is 2 then it corresponds to</span>
      <span class="c">!! the upper bound.</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">resolution</span>
      <span class="c">!! The number of data points in each dimension.</span>
    <span class="k">procedure</span><span class="p">(</span><span class="n">thickness_func</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">thickness</span>
      <span class="c">!! A function which calculates the initial value of the thickness of </span>
      <span class="c">!! the ice shelf at a given location.</span>
    <span class="k">procedure</span><span class="p">(</span><span class="n">velocity_func</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">velocity</span>
      <span class="c">!! A function which calculates the initial value of the velocity </span>
      <span class="c">!! (vector) of the ice at a given location in an ice shelf.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>       <span class="kd">::</span> <span class="n">temperature</span>
      <span class="c">!! The temperature of the ice in the ice shelf.</span>
    <span class="k">class</span><span class="p">(</span><span class="n">abstract_viscosity</span><span class="p">),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="p">&amp;</span>
                           <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">viscosity_law</span>
      <span class="c">!! An object which calculates the viscosity of the ice. If not</span>
      <span class="c">!! specified, then Glen&#39;s law will be used with $n=3$. Will be</span>
      <span class="c">!! unallocated on return.</span>
    <span class="k">class</span><span class="p">(</span><span class="n">glacier_boundary</span><span class="p">),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="p">&amp;</span>
                         <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">boundaries</span>
      <span class="c">!! An object specifying the boundary conditions for the ice</span>
      <span class="c">!! shelf. Will be unallocated on return.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>       <span class="kd">::</span> <span class="n">lambda</span>
      <span class="c">!! The dimensionless ratio </span>
      <span class="c">!! $\lambda \equiv \frac{\rho_0m_0x_0}{\rho_ih_0u_0}$.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>       <span class="kd">::</span> <span class="n">chi</span>
      <span class="c">!! The dimensionless ratio</span>
      <span class="c">!! $\chi \equiv \frac{\rho_igh_0x_x}{2\eta_0u_0}\left(1 -</span>
      <span class="c">!! \frac{\rho_i}{\rho_0}\right)$.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>       <span class="kd">::</span> <span class="n">zeta</span>
      <span class="c">!! The dimensionless ratio $\zeta \equiv</span>
      <span class="c">!! \frac{\rho_iu_0x_0}{\eta_0}$, corresponding to the Reynolds</span>
      <span class="c">!! number. Currently this is unused and always treated as 0.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>       <span class="kd">::</span> <span class="n">courant</span>
      <span class="c">!! The Courant number to use when calculating the time</span>
      <span class="c">!! step. Defaults to 100. Too large a value will pose</span>
      <span class="c">!! difficulties for the nonlinear solver, while too small a</span>
      <span class="c">!! value can be numerically unstable. Typically, smaller values</span>
      <span class="c">!! are needed for lower resolution.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>       <span class="kd">::</span> <span class="n">max_dt</span>
      <span class="c">!! The maximum allowable time step. This defaults to \(1\times</span>
      <span class="c">!! 10^{99}\) (effectively no maximum).</span>
    <span class="k">procedure</span><span class="p">(</span><span class="n">kappa_init_func</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">kappa</span>
      <span class="c">!! A function which specifies the initial values of the Taylor</span>
      <span class="c">!! coefficients describing the vertical distribution of internal</span>
      <span class="c">!! reflectors within the ice. The initial conditions at the</span>
      <span class="c">!! grounding line will provide the boundary conditions there</span>
      <span class="c">!! throughout the simulation. If this parameter is not provided</span>
      <span class="c">!! then these layers will not be included in the</span>
      <span class="c">!! integration. Both this parameter and `n_kappa` must be</span>
      <span class="c">!! specified for the calculation to take place.</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">n_kappa</span>
      <span class="c">!! The number of Taylor coefficients used to describe internal</span>
      <span class="c">!! reflectors. If not provided then these reflectors will not be</span>
      <span class="c">!! included in the integration. Both this parameter and `kappa`</span>
      <span class="c">!! must be specified for the calculation to take place.</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>

    <span class="n">this</span><span class="p">%</span><span class="n">thickness</span> <span class="o">=</span> <span class="n">cheb1d_scalar_field</span><span class="p">(</span><span class="n">resolution</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">thickness</span><span class="p">,</span><span class="n">domain</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
                                         <span class="n">domain</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">this</span><span class="p">%</span><span class="n">velocity</span> <span class="o">=</span> <span class="n">cheb1d_vector_field</span><span class="p">(</span><span class="n">resolution</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">velocity</span><span class="p">,</span><span class="n">domain</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
                                        <span class="n">domain</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">this</span><span class="p">%</span><span class="n">eta</span> <span class="o">=</span> <span class="n">cheb1d_scalar_field</span><span class="p">(</span><span class="n">resolution</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">lower_bound</span><span class="o">=</span><span class="n">domain</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
                                   <span class="n">upper_bound</span><span class="o">=</span><span class="n">domain</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">this</span><span class="p">%</span><span class="n">thickness_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">thickness</span><span class="p">%</span><span class="n">raw_size</span><span class="p">()</span>
    <span class="n">this</span><span class="p">%</span><span class="n">velocity_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">velocity</span><span class="p">%</span><span class="n">raw_size</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">kappa</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">present</span><span class="p">(</span><span class="n">n_kappa</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">kappa</span><span class="p">(</span><span class="n">n_kappa</span><span class="p">))</span>
      <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_kappa</span>
        <span class="n">this</span><span class="p">%</span><span class="n">kappa</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">cheb1d_scalar_field</span><span class="p">(</span><span class="n">resolution</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">kappa_func</span><span class="p">,</span><span class="n">domain</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
                                            <span class="n">domain</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
      <span class="k">end do</span>
<span class="k">    end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">temperature</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      continue</span> <span class="c">! This doesn&#39;t do anything at the moment</span>
    <span class="k">else</span>
<span class="k">      continue</span> <span class="c">! Again, doesn&#39;t do anything at the moment</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">viscosity_law</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      call </span><span class="nb">move_alloc</span><span class="p">(</span><span class="n">viscosity_law</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">viscosity_law</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      allocate</span><span class="p">(</span><span class="n">newtonian_viscosity</span><span class="kd">::</span> <span class="n">this</span><span class="p">%</span><span class="n">viscosity_law</span><span class="p">)</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">boundaries</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      call </span><span class="nb">move_alloc</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">boundaries</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      allocate</span><span class="p">(</span><span class="n">dallaston2015_glacier_boundary</span> <span class="kd">::</span> <span class="n">this</span><span class="p">%</span><span class="n">boundaries</span><span class="p">)</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">lambda</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">lambda</span> <span class="o">=</span> <span class="n">lambda</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">lambda</span> <span class="o">=</span> <span class="mf">0.37_r8</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">chi</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">chi</span> <span class="o">=</span> <span class="n">chi</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">chi</span> <span class="o">=</span> <span class="mf">4.0_r8</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">zeta</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">zeta</span> <span class="o">=</span> <span class="n">zeta</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">zeta</span> <span class="o">=</span> <span class="mf">1.3e-11_r8</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">courant</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">courant</span> <span class="o">=</span> <span class="n">courant</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">courant</span> <span class="o">=</span> <span class="err">1</span><span class="n">e2_r8</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">max_dt</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">max_dt</span> <span class="o">=</span> <span class="n">max_dt</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">this</span><span class="p">%</span><span class="n">max_dt</span> <span class="o">=</span> <span class="err">1</span><span class="n">e99_r8</span>
    <span class="k">end if</span>

<span class="k">    </span><span class="n">lower</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">boundaries</span><span class="p">%</span><span class="n">thickness_lower_bound</span><span class="p">()</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">boundaries</span><span class="p">%</span><span class="n">thickness_upper_bound</span><span class="p">()</span>
    <span class="n">this</span><span class="p">%</span><span class="n">thickness_lower_bound_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">thickness_size</span> <span class="p">&amp;</span>
                                    <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">thickness</span><span class="p">%</span><span class="n">raw_size</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
    <span class="n">this</span><span class="p">%</span><span class="n">thickness_upper_bound_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">thickness_size</span> <span class="p">&amp;</span>
                                    <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">thickness</span><span class="p">%</span><span class="n">raw_size</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>

    <span class="n">lower</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">boundaries</span><span class="p">%</span><span class="n">velocity_lower_bound</span><span class="p">()</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">boundaries</span><span class="p">%</span><span class="n">velocity_upper_bound</span><span class="p">()</span>
    <span class="n">this</span><span class="p">%</span><span class="n">velocity_lower_bound_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">velocity_size</span> <span class="p">&amp;</span>
                                   <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">velocity</span><span class="p">%</span><span class="n">raw_size</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
    <span class="n">this</span><span class="p">%</span><span class="n">velocity_upper_bound_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">velocity_size</span> <span class="p">&amp;</span>
                                   <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">velocity</span><span class="p">%</span><span class="n">raw_size</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>

    <span class="n">this</span><span class="p">%</span><span class="n">boundary_start</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">thickness_size</span> <span class="o">+</span> <span class="n">this</span><span class="p">%</span><span class="n">velocity_size</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">&amp;</span>
                        <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">thickness_lower_bound_size</span> <span class="p">&amp;</span>
                        <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">thickness_upper_bound_size</span> <span class="p">&amp;</span>
                        <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">velocity_lower_bound_size</span> <span class="p">&amp;</span>
                        <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">velocity_upper_bound_size</span>

    <span class="n">this</span><span class="p">%</span><span class="nb">time</span> <span class="o">=</span> <span class="mf">0.0_r8</span>
    <span class="n">this</span><span class="p">%</span><span class="n">stale_eta</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
    <span class="n">this</span><span class="p">%</span><span class="n">stale_jacobian</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="cp">#ifdef DEBUG</span>
    <span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;ice_shelf&#39;</span><span class="p">,</span><span class="s1">&#39;Initialised new ice shelf object&#39;</span><span class="p">)</span>
<span class="cp">#endif</span>

  <span class="k">contains</span>

<span class="k">    pure function </span><span class="n">kappa_func</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">thickness</span><span class="p">)</span>
      <span class="c">!* Author: Chris MacMackin</span>
      <span class="c">!  Date: April 2016</span>
      <span class="c">!</span>
      <span class="c">! Wrapper around user-provided `kappa` routine, converting it to</span>
      <span class="c">! the form needed to initialise field-types.</span>
      <span class="c">!</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">location</span>
        <span class="c">!! The position $\vec{x}$ at which to compute the thickness</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thickness</span>
        <span class="c">!! The thickness of the glacier at `location`</span>
      <span class="n">thickness</span> <span class="o">=</span> <span class="n">kappa</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
    <span class="k">end function </span><span class="n">kappa_func</span>

  <span class="k">end subroutine </span><span class="n">shelf_initialise</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ISOFT was developed by Chris MacMackin</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="../js/MathJax-config/mj-config.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>