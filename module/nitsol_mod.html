<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Ice Shelf/Ocean Fluid- and Thermodynamics: a suite of tools and programs to use for simulating the evolution of ice shelves interacting with the ocean.">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>nitsol_mod &ndash; ISOFT</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ISOFT </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>nitsol_mod 
    <small>Module</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     <li><i class="fa fa-pencil"></i> Christopher MacMackin</li>
     
     
    <li><i class="fa fa-calendar-o"></i> July 2016</li>
     
     
    <li><i class="fa fa-legal"></i> GPLv3</li>
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 5.6% of total for modules and submodules.">544 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/nitsol.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/nitsol.f90.html'>nitsol.f90</a></li>
    
  
     <li class="active">nitsol_mod</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-0">Common Blocks</a></h3></div>
  <div id="common-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/nitsol_mod.html#common-nitprint%7E4">nitprint</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#common-nitinfo">nitinfo</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#common-nitparam">nitparam</a>
      
    </div>
  </div>
</div>










<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#inters-0">Interfaces</a></h3></div>
  <div id="inters-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-nitsol">nitsol</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-nitgm2">nitgm2</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-nittfq2">nittfq2</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-nitstb2">nitstb2</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-ddot">ddot</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-dnrm2">dnrm2</a>
      
    </div>
  </div>
</div>



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#absints-0">Abstract Interfaces</a></h3></div>
  <div id="absints-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-dinpr_intr">dinpr_intr</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-dnorm_intr">dnorm_intr</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-mat_mult">mat_mult</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-f_intr%7E2">f_intr</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-jacv_intr">jacv_intr</a>
      
    </div>
  </div>
</div>





<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-dummy_jacv">dummy_jacv</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-dummy_f">dummy_f</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-gmres_solve">gmres_solve</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-tfqmr_solve">tfqmr_solve</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-bicgstab_solve">bicgstab_solve</a>
      
    </div>
  </div>
</div>










</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <p>Provides an explicit interface to the
 <a href="http://users.wpi.edu/~walker/Papers/nitsol,SISC_19,1998,302-318.pdf">NITSOL</a>
 package. Variables held in common blocks which can be used to
 control NITSOL are also provided here. At some point I may produce
 a proper object oriented interface for it.</p>
<p>Also present is an interface to the GMRES solver provided by
 NITSOL. Both a direct interface and a wrapper are provided. The
 wrapper offers a somewhat more general and F90-ish presentation of
 the routine.</p>
      <br>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href="http://fortranwiki.org/fortran/show/ISO_FORTRAN_ENV">iso_fortran_env</a></li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: module~~nitsol_mod~~UsesGraph Pages: 1 -->
<svg id="modulenitsol_modUsesGraph" width="196pt" height="32pt"
 viewBox="0.00 0.00 196.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="module~~nitsol_mod~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>module~~nitsol_mod~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 192,-28 192,4 -4,4"/>
<!-- module~nitsol_mod -->
<g id="module~~nitsol_mod~~UsesGraph_node1" class="node"><title>module~nitsol_mod</title>
<polygon fill="none" stroke="black" points="188,-24 124,-24 124,-0 188,-0 188,-24"/>
<text text-anchor="middle" x="156" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">nitsol_mod</text>
</g>
<!-- iso_fortran_env -->
<g id="module~~nitsol_mod~~UsesGraph_node2" class="node"><title>iso_fortran_env</title>
<g id="a_module~~nitsol_mod~~UsesGraph_node2"><a xlink:href="http://fortranwiki.org/fortran/show/ISO_FORTRAN_ENV" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="87.5,-24 0.5,-24 0.5,-0 87.5,-0 87.5,-24"/>
<text text-anchor="middle" x="44" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- module~nitsol_mod&#45;&gt;iso_fortran_env -->
<g id="module~~nitsol_mod~~UsesGraph_edge1" class="edge"><title>module~nitsol_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M123.773,-12C115.738,-12 106.865,-12 98.058,-12"/>
<polygon fill="#000000" stroke="#000000" points="97.8045,-8.5001 87.8045,-12 97.8044,-15.5001 97.8045,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="489pt" height="32pt"
 viewBox="0.00 0.00 489.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485,-28 485,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.25,-24 72.75,-24 72.75,-0 139.25,-0 139.25,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.25,-24 384.75,-24 384.75,-0 481.25,-0 481.25,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    

    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Used by</h3>
      </div>
      <ul class="list-group">
  
  
  <li class="list-group-item">
    <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: module~~nitsol_mod~~UsedByGraph Pages: 1 -->
<svg id="modulenitsol_modUsedByGraph" width="420pt" height="284pt"
 viewBox="0.00 0.00 420.00 284.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="module~~nitsol_mod~~UsedByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 280)">
<title>module~~nitsol_mod~~UsedByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-280 416,-280 416,4 -4,4"/>
<!-- module~nitsol_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node1" class="node"><title>module~nitsol_mod</title>
<polygon fill="none" stroke="black" points="64,-170 0,-170 0,-146 64,-146 64,-170"/>
<text text-anchor="middle" x="32" y="-155.6" font-family="Helvetica,sans-Serif" font-size="10.50">nitsol_mod</text>
</g>
<!-- module~ice_shelf_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node2" class="node"><title>module~ice_shelf_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node2"><a xlink:href=".././module/ice_shelf_mod.html" xlink:title="ice_shelf_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="388,-276 306,-276 306,-252 388,-252 388,-276"/>
<text text-anchor="middle" x="347" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ice_shelf_mod</text>
</a>
</g>
</g>
<!-- module~ice_shelf_mod&#45;&gt;module~nitsol_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge1" class="edge"><title>module~ice_shelf_mod&#45;&gt;module~nitsol_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M305.812,-269.378C254.745,-274.253 165.39,-276.084 100,-241 74.1967,-227.156 54.7075,-198.748 43.5768,-179.049"/>
<polygon fill="#000000" stroke="#000000" points="46.6209,-177.32 38.793,-170.18 40.4601,-180.643 46.6209,-177.32"/>
</g>
<!-- module~glacier_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node4" class="node"><title>module~glacier_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node4"><a xlink:href=".././module/glacier_mod.html" xlink:title="glacier_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="208.5,-232 137.5,-232 137.5,-208 208.5,-208 208.5,-232"/>
<text text-anchor="middle" x="173" y="-217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">glacier_mod</text>
</a>
</g>
</g>
<!-- module~ice_shelf_mod&#45;&gt;module~glacier_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge7" class="edge"><title>module~ice_shelf_mod&#45;&gt;module~glacier_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M305.674,-253.684C279.524,-246.995 245.438,-238.275 218.499,-231.383"/>
<polygon fill="#000000" stroke="#000000" points="219.111,-227.927 208.555,-228.84 217.376,-234.709 219.111,-227.927"/>
</g>
<!-- module~cryosphere_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node3" class="node"><title>module~cryosphere_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node3"><a xlink:href=".././module/cryosphere_mod.html" xlink:title="cryosphere_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="393.5,-192 300.5,-192 300.5,-168 393.5,-168 393.5,-192"/>
<text text-anchor="middle" x="347" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cryosphere_mod</text>
</a>
</g>
</g>
<!-- module~cryosphere_mod&#45;&gt;module~nitsol_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge2" class="edge"><title>module~cryosphere_mod&#45;&gt;module~nitsol_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M300.487,-176.801C239.707,-172.529 132.913,-165.023 74.3326,-160.905"/>
<polygon fill="#000000" stroke="#000000" points="74.5436,-157.411 64.3228,-160.202 74.0527,-164.394 74.5436,-157.411"/>
</g>
<!-- module~cryosphere_mod&#45;&gt;module~glacier_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge8" class="edge"><title>module~cryosphere_mod&#45;&gt;module~glacier_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M300.359,-190.614C275.079,-196.493 243.783,-203.771 218.662,-209.613"/>
<polygon fill="#000000" stroke="#000000" points="217.609,-206.265 208.662,-211.939 219.195,-213.083 217.609,-206.265"/>
</g>
<!-- module~basal_surface_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node6" class="node"><title>module~basal_surface_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node6"><a xlink:href=".././module/basal_surface_mod.html" xlink:title="basal_surface_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="226,-150 120,-150 120,-126 226,-126 226,-150"/>
<text text-anchor="middle" x="173" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">basal_surface_mod</text>
</a>
</g>
</g>
<!-- module~cryosphere_mod&#45;&gt;module~basal_surface_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge14" class="edge"><title>module~cryosphere_mod&#45;&gt;module~basal_surface_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M300.359,-168.855C279.732,-163.818 255.099,-157.803 233.083,-152.427"/>
<polygon fill="#000000" stroke="#000000" points="233.721,-148.98 223.176,-150.008 232.06,-155.78 233.721,-148.98"/>
</g>
<!-- module~glacier_mod&#45;&gt;module~nitsol_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge3" class="edge"><title>module~glacier_mod&#45;&gt;module~nitsol_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M137.226,-207.938C125.296,-203.543 111.945,-198.336 100,-193 87.8304,-187.564 74.7714,-180.933 63.4443,-174.91"/>
<polygon fill="#000000" stroke="#000000" points="64.8579,-171.696 54.3943,-170.033 61.5374,-177.858 64.8579,-171.696"/>
</g>
<!-- module~ode_solvers_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node5" class="node"><title>module~ode_solvers_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node5"><a xlink:href=".././module/ode_solvers_mod.html" xlink:title="ode_solvers_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="221.5,-108 124.5,-108 124.5,-84 221.5,-84 221.5,-108"/>
<text text-anchor="middle" x="173" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ode_solvers_mod</text>
</a>
</g>
</g>
<!-- module~ode_solvers_mod&#45;&gt;module~nitsol_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge4" class="edge"><title>module~ode_solvers_mod&#45;&gt;module~nitsol_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M124.494,-107.908C116.191,-110.537 107.74,-113.576 100,-117 85.6891,-123.33 70.746,-132.223 58.6128,-140.11"/>
<polygon fill="#000000" stroke="#000000" points="56.3229,-137.43 49.9392,-145.885 60.2027,-143.256 56.3229,-137.43"/>
</g>
<!-- module~basal_surface_mod&#45;&gt;module~nitsol_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge6" class="edge"><title>module~basal_surface_mod&#45;&gt;module~nitsol_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M119.846,-145.504C104.721,-147.68 88.4245,-150.025 74.0797,-152.089"/>
<polygon fill="#000000" stroke="#000000" points="73.4236,-148.648 64.024,-153.536 74.4206,-155.576 73.4236,-148.648"/>
</g>
<!-- module~finite_difference_block_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node7" class="node"><title>module~finite_difference_block_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node7"><a xlink:href=".././module/finite_difference_block_mod.html" xlink:title="finite_difference_block_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="246,-66 100,-66 100,-42 246,-42 246,-66"/>
<text text-anchor="middle" x="173" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">finite_difference_block_mod</text>
</a>
</g>
</g>
<!-- module~finite_difference_block_mod&#45;&gt;module~nitsol_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge5" class="edge"><title>module~finite_difference_block_mod&#45;&gt;module~nitsol_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M117.318,-66.0474C111.224,-68.5096 105.31,-71.4624 100,-75 76.0053,-90.987 56.4145,-118.229 44.7462,-137.122"/>
<polygon fill="#000000" stroke="#000000" points="41.6353,-135.505 39.5275,-145.888 47.6502,-139.086 41.6353,-135.505"/>
</g>
<!-- module~ground_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node8" class="node"><title>module~ground_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node8"><a xlink:href=".././module/ground_mod.html" xlink:title="ground_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="383.5,-150 310.5,-150 310.5,-126 383.5,-126 383.5,-150"/>
<text text-anchor="middle" x="347" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ground_mod</text>
</a>
</g>
</g>
<!-- module~ground_mod&#45;&gt;module~basal_surface_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge13" class="edge"><title>module~ground_mod&#45;&gt;module~basal_surface_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M310.361,-138C289,-138 261.239,-138 236.344,-138"/>
<polygon fill="#000000" stroke="#000000" points="236.242,-134.5 226.242,-138 236.242,-141.5 236.242,-134.5"/>
</g>
<!-- module~asymmetric_plume_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node9" class="node"><title>module~asymmetric_plume_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node9"><a xlink:href=".././module/asymmetric_plume_mod.html" xlink:title="asymmetric_plume_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="412,-108 282,-108 282,-84 412,-84 412,-108"/>
<text text-anchor="middle" x="347" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">asymmetric_plume_mod</text>
</a>
</g>
</g>
<!-- module~asymmetric_plume_mod&#45;&gt;module~ode_solvers_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge10" class="edge"><title>module~asymmetric_plume_mod&#45;&gt;module~ode_solvers_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.954,-96C265.579,-96 248.065,-96 232.013,-96"/>
<polygon fill="#000000" stroke="#000000" points="231.701,-92.5001 221.701,-96 231.701,-99.5001 231.701,-92.5001"/>
</g>
<!-- module~asymmetric_plume_mod&#45;&gt;module~basal_surface_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge15" class="edge"><title>module~asymmetric_plume_mod&#45;&gt;module~basal_surface_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M296.712,-108.036C276.92,-112.868 253.935,-118.481 233.244,-123.533"/>
<polygon fill="#000000" stroke="#000000" points="232.18,-120.19 223.295,-125.963 233.84,-126.991 232.18,-120.19"/>
</g>
<!-- module~ice_sheet_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node10" class="node"><title>module~ice_sheet_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node10"><a xlink:href=".././module/ice_sheet_mod.html" xlink:title="ice_sheet_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="389.5,-234 304.5,-234 304.5,-210 389.5,-210 389.5,-234"/>
<text text-anchor="middle" x="347" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ice_sheet_mod</text>
</a>
</g>
</g>
<!-- module~ice_sheet_mod&#45;&gt;module~glacier_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge9" class="edge"><title>module~ice_sheet_mod&#45;&gt;module~glacier_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M304.364,-221.516C278.471,-221.215 245.191,-220.828 218.737,-220.52"/>
<polygon fill="#000000" stroke="#000000" points="218.637,-217.019 208.597,-220.402 218.555,-224.018 218.637,-217.019"/>
</g>
<!-- module~static_plume_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node11" class="node"><title>module~static_plume_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node11"><a xlink:href=".././module/static_plume_mod.html" xlink:title="static_plume_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="397,-66 297,-66 297,-42 397,-42 397,-66"/>
<text text-anchor="middle" x="347" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">static_plume_mod</text>
</a>
</g>
</g>
<!-- module~static_plume_mod&#45;&gt;module~ode_solvers_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge11" class="edge"><title>module~static_plume_mod&#45;&gt;module~ode_solvers_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M296.712,-66.0355C276.316,-71.0159 252.529,-76.8244 231.356,-81.9944"/>
<polygon fill="#000000" stroke="#000000" points="230.402,-78.6246 221.517,-84.3969 232.062,-85.4248 230.402,-78.6246"/>
</g>
<!-- module~static_plume_mod&#45;&gt;module~basal_surface_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge16" class="edge"><title>module~static_plume_mod&#45;&gt;module~basal_surface_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M299.145,-66.0325C293.131,-68.5244 287.249,-71.4888 282,-75 261.566,-88.6705 266.659,-103.671 246,-117 242.709,-119.123 239.198,-121.037 235.563,-122.762"/>
<polygon fill="#000000" stroke="#000000" points="234.173,-119.55 226.329,-126.672 236.902,-125.996 234.173,-119.55"/>
</g>
<!-- module~plume_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_node12" class="node"><title>module~plume_mod</title>
<g id="a_module~~nitsol_mod~~UsedByGraph_node12"><a xlink:href=".././module/plume_mod.html" xlink:title="plume_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="381.5,-24 312.5,-24 312.5,-0 381.5,-0 381.5,-24"/>
<text text-anchor="middle" x="347" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">plume_mod</text>
</a>
</g>
</g>
<!-- module~plume_mod&#45;&gt;module~ode_solvers_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge12" class="edge"><title>module~plume_mod&#45;&gt;module~ode_solvers_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M312.196,-19.3446C301.957,-22.5279 291.039,-26.9529 282,-33 261.566,-46.6705 266.659,-61.6712 246,-75 241.418,-77.956 236.409,-80.5068 231.235,-82.706"/>
<polygon fill="#000000" stroke="#000000" points="229.901,-79.4686 221.799,-86.2961 232.39,-86.011 229.901,-79.4686"/>
</g>
<!-- module~plume_mod&#45;&gt;module~basal_surface_mod -->
<g id="module~~nitsol_mod~~UsedByGraph_edge17" class="edge"><title>module~plume_mod&#45;&gt;module~basal_surface_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M312.283,-17.3741C301.58,-20.4687 290.365,-25.3391 282,-33 252.046,-60.4322 276.406,-90.0697 246,-117 242.765,-119.865 239.159,-122.34 235.332,-124.478"/>
<polygon fill="#000000" stroke="#000000" points="233.601,-121.426 226.073,-128.881 236.607,-127.748 233.601,-121.426"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="489pt" height="32pt"
 viewBox="0.00 0.00 489.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485,-28 485,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.25,-24 72.75,-24 72.75,-0 139.25,-0 139.25,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.25,-24 384.75,-24 384.75,-0 481.25,-0 481.25,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
  </li>
  
      </ul>
    </div>
    

    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-1">Common Blocks</a></h3></div>
  <div id="common-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/nitsol_mod.html#common-nitprint%7E4">nitprint</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#common-nitinfo">nitinfo</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#common-nitparam">nitparam</a>
      
    </div>
  </div>
</div>










<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#inters-1">Interfaces</a></h3></div>
  <div id="inters-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-nitsol">nitsol</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-nitgm2">nitgm2</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-nittfq2">nittfq2</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-nitstb2">nitstb2</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-ddot">ddot</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-dnrm2">dnrm2</a>
      
    </div>
  </div>
</div>



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#absints-1">Abstract Interfaces</a></h3></div>
  <div id="absints-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-dinpr_intr">dinpr_intr</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-dnorm_intr">dnorm_intr</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-mat_mult">mat_mult</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-f_intr%7E2">f_intr</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#interface-jacv_intr">jacv_intr</a>
      
    </div>
  </div>
</div>





<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-dummy_jacv">dummy_jacv</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-dummy_f">dummy_f</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-gmres_solve">gmres_solve</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-tfqmr_solve">tfqmr_solve</a>
      
      <a class="list-group-item" href="../module/nitsol_mod.html#proc-bicgstab_solve">bicgstab_solve</a>
      
    </div>
  </div>
</div>










    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
      <h2>Common Blocks</h2>
      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-nitprint%7E4"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4><a href='../proc/nitstb2.html#common-nitprint'>nitstb2</a> (subroutine)<br><a href='../proc/nitgm2.html#common-nitprint%7E2'>nitgm2</a> (subroutine)<br><a href='../proc/nittfq2.html#common-nitprint%7E3'>nittfq2</a> (subroutine)<br>">common /nitprint/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iplvl%7E4"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>iplvl</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ipunit%7E4"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ipunit</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-nitinfo"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4>">common /nitinfo/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-avrate"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>avrate</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fcurnrm"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>fcurnrm</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-instep"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>instep</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-newstep"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>newstep</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-krystat"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>krystat</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-nitparam"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4>">common /nitparam/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-choice1_exp"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>choice1_exp</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-choice2_exp"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>choice2_exp</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-choice2_coef"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>choice2_coef</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eta_cutoff"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>eta_cutoff</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-etamax"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>etamax</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-thmin"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>thmin</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-thmax"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>thmax</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-etafixed"></span>real(kind=r8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>etafixed</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
    </section>
    <br>
    <script>
    $(function () {
    $('[data-toggle="popover"]').popover()
    })
    </script>
    

    
    
    
    
    
    <section>
   <h2>Interfaces</h2>
   
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-nitsol"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
public subroutine nitsol(n, x, f, jacv, ftol, stptol, input, info, rwork, rpar, ipar, iterm, dinpr, dnorm)
    
    
   
</h3>
    



<p>An explicit interface to the 
 <a href="http://users.wpi.edu/~walker/Papers/nitsol,SISC_19,1998,302-318.pdf">nitsol</a>
 Newton iterative nonlinear solver.</p><a href="../interface/nitsol.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>Dimension of the problem</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>x</strong></td><td><p>Vector of length n, initial guess on input and final
 approximate solution on output</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/f_intr%7E2.html'>f_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td><p>User-supplied subroutine for evaluating the function
 the zero of which is sought.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/jacv_intr.html'>jacv_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>jacv</strong></td><td><p>User-supplied subroutine for optionally evaluating
 <script type="math/tex">J\vec{v}</script> or <script type="math/tex">P^{-1}\vec{v}</script>, where <script type="math/tex">J</script> is the Jacobian
 of <script type="math/tex">f</script> and <script type="math/tex">P</script> is a right preconditioning operator. If
 neither analytic <script type="math/tex">J\vec{v}</script> evaluations nor right
 preconditioning is used, this can be a dummy subroutine;
 if right preconditioning is used but not analytic
 <script type="math/tex">J\vec{v}</script> evaluations, this need only evaluate
 <script type="math/tex">P^{-1}\vec{v}</script>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ftol</strong></td><td><p>Stopping tolerance of the f-norm</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stptol</strong></td><td><p>Stopping tolerance of the step-length</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(10)</td><td>::</td>
  <td><strong>input</strong></td><td><p>Array containing various user-specified inputs; see above</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(6)</td><td>::</td>
  <td><strong>info</strong></td><td><p>Array containing various outputs; see above</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rwork</strong></td><td><p>Work array with length depending on the solver used as follows:</p>
<dl>
<dt>GMRES</dt>
<dd>
<script type="math/tex">n\times(\text{kdmax}+5)+\text{kdmax}\times(\text{kdmax}+3)</script>,
 where kdmax is the maximum Krylove subspace dimension, either
 the default value of 20 or another value specified by the user</dd>
<dt>BiCGSTAB</dt>
<dd>
<script type="math/tex">11n</script>
</dd>
<dt>TFQMR</dt>
<dd>
<script type="math/tex">14n</script>
</dd>
</dl></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array passed to the <code>f</code> and <code>jacv</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array passed to the <code>f</code> and <code>jacv</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iterm</strong></td><td><p>Termination flag. Values have the following meanings:</p>
<dl>
<dt>-k</dt>
<dd>illegal value in <code>input(k)</code></dd>
<dt>0</dt>
<dd>normal termination: <script type="math/tex">||F|| < \text{ftol}</script> or <script type="math/tex">||\text{step}||
 < \text{stptol}</script>
</dd>
<dt>1</dt>
<dd><code>nnimax</code> nonlinar iterations reached without success</dd>
<dt>2</dt>
<dd>failure to evaluate <script type="math/tex">F</script>
</dd>
<dt>3</dt>
<dd>in <code>nitjv</code>, <script type="math/tex">J\vec{v}</script>  failure</dd>
<dt>4</dt>
<dd>in <code>nitjv</code>, <script type="math/tex">P^{-1}\vec{v}</script> failure</dd>
<dt>5</dt>
<dd>in <code>nitdrv</code>, insufficient initial model norm reduction for
 adequate progress. <strong>Note:</strong> This can occur for several
 reasons; examine <code>itrmks</code> on return from the Krylov solver
 for further information. (This will be printed out if
 <script type="math/tex">\text{iplvl}\ge 3</script>; see the discussion of optional common
 blocks below.)</dd>
<dt>6</dt>
<dd>in <code>nitbt</code>, failure to reach an acceptable step through
 backtracking</dd>
</dl></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dinpr_intr.html'>dinpr_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dinpr</strong></td><td><p>User-supplied function for calculating vector inner products.
 This has the same interace as the BLAS routine
 <a href="http://www.netlib.org/lapack/explore-html/de/da4/group__double__blas__level1_ga75066c4825cb6ff1c8ec4403ef8c843a.html">ddot</a>.
 If the Euclidean inner product is desired then user can link
 to a local BLAS library and provide the name <code>ddot</code> to <code>nitsol</code>.
 <code>dinpr</code> must be declared as an external function that returns
 a double precision in the calling program.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dnorm_intr.html'>dnorm_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dnorm</strong></td><td><p>User-supplied function for calculating vector norms. This
 has the same interface as the BLAS routine dnrm2; if the
 Euclidean norm is desired the user can link to a local
 BLAS library and provide the name dnrm2 to nitsol.  dnorm
 must be declared as an external function that returns a
 double precision value in the calling program.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

    </li>
  
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-nitgm2"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
public subroutine nitgm2(n, xcur, fcur, step, eta, f, jacv, rpar, ipar, ijacv, irpre, iksmax, iresup, ifdord, nfe, njve, nrpre, nli, kdmax, kdmaxp1, vv, rr, svbig, svsml, w, rwork, rsnrm, dinpr, dnorm, itrmks)
    
    
   
</h3>
    



<p>An interface to my modified versino of the
 <a href="http://users.wpi.edu/~walker/Papers/nitsol,SISC_19,1998,302-318.pdf">nitsol</a>
 implementation of the generalised minimal residual method
 (<a href="https://en.wikipedia.org/wiki/Generalized_minimal_residual_method">GMRES</a>)
 for iteratively solving linear systems. It has been modified
 so that the user provides a non-zero initial guess of the
 solution.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>Dimension of the problem</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>xcur</strong></td><td><p>Array of length <code>n</code> containing the current <script type="math/tex">x</script> value</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>fcur</strong></td><td><p>Array of length <code>n</code> containing current approximate solution</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>step</strong></td><td><p>Vector of of length <code>n</code> containing trial step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eta</strong></td><td><p>Relative residual reduction factor</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/f_intr%7E2.html'>f_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td><p>User-supplied subroutine for evaluating the function
 the zero of which is sought.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/jacv_intr.html'>jacv_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>jacv</strong></td><td><p>User-supplied subroutine for optionally evaluating
 <script type="math/tex">J\vec{v}</script> or <script type="math/tex">P^{-1}\vec{v}</script>, where <script type="math/tex">J</script> is the Jacobian
 of <script type="math/tex">f</script> and <script type="math/tex">P</script> is a right preconditioning operator. If
 neither analytic <script type="math/tex">J\vec{v}</script> evaluations nor right
 preconditioning is used, this can be a dummy subroutine;
 if right preconditioning is used but not analytic
 <script type="math/tex">J\vec{v}</script> evaluations, this need only evaluate
 <script type="math/tex">P^{-1}\vec{v}</script>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array passed to the <code>f</code> and <code>jacv</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array passed to the <code>f</code> and <code>jacv</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ijacv</strong></td><td><p>Flag for determining method of <script type="math/tex">J\vec{v}</script> evaluation. 0
 (default) indicates finite-difference evaluation, while 1
 indicates analytic evaluation.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>irpre</strong></td><td><p>Flag for right preconditioning. 0 indicates no
 preconditioning, while 1 inidcates right preconditioning.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iksmax</strong></td><td><p>Maximum allowable number of GMRES iterations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iresup</strong></td><td><p>Residual update flag. On GMRES restarts, the residual can
 be updated using a linear combination (<code>iresup == 0</code>) or by
 direct evaluation (<code>iresup == 1</code>). The first is cheap (one
 n-vector saxpy) but may lose accuracy with extreme residual
 reduction; the second retains accuracy better but costs one
 <script type="math/tex">J\vec{v}</script> product.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ifdord</strong></td><td><p>Order of the finite-difference formula (sometimes) used on
 GMRES restarts when <script type="math/tex">J\vec{v}</script> products are evaluated
 using finite- differences. When ijacv = 0 on input to
 nitsol, ifdord is set to 1, 2, or 4 in nitsol; otherwise,
 it is irrelevant. When ijacv = 0 on input to this
 subroutine, the precise meaning is as follows:</p>
<p>With GMRES, ifdord matters only if iresup = 1, in which case<br>
 it determines the order of the finite-difference formula used 
 in evaluating the initial residual at each GMRES restart    <br>
 (default 2). If iresup = 1 and ijacv = 0 on input to this   <br>
 subroutine, then ijacv is temporarily reset to -1 at each   <br>
 restart below to force a finite-difference evaluation of order
 ifdord. NOTE: This only affects initial residuals at restarts;
 first-order differences are always used within each GMRES   <br>
 cycle. Using higher-order differences at restarts only should 
 give the same accuracy as if higher-order differences were  <br>
 used throughout; see K. Turner and H. F. Walker, "Efficient <br>
 high accuracy solutions with GMRES(m)," SIAM J. Sci. Stat.  <br>
 Comput., 13 (1992), pp. 815--825.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nfe</strong></td><td><p>Number of function evaluations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>njve</strong></td><td><p>Number of <script type="math/tex">J\vec{v}</script> evaluations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nrpre</strong></td><td><p>Number of <script type="math/tex">P^{-1}\vec{v}</script> evaluations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nli</strong></td><td><p>Number of linear iterations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>kdmax</strong></td><td><p>Maximum Krylov subspace dimension; default 10.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>kdmaxp1</strong></td><td><p>kdmax + 1</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n, kdmaxp1)</td><td>::</td>
  <td><strong>vv</strong></td><td><p>Matrix for storage of Krylov basis in GMRES; on return, the
 residual vector is contained in the first column.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(kdmax, kdmax)</td><td>::</td>
  <td><strong>rr</strong></td><td><p>Matrix for storage of triangular matrix in GMRES.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(kdmax)</td><td>::</td>
  <td><strong>svbig</strong></td><td><p>Vector for storage of estimate of singular vector of <code>rr</code>
 with largest singular value.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(kdmax)</td><td>::</td>
  <td><strong>svsml</strong></td><td><p>Vector for storage of estimate of singular vector of <code>rr</code>
 with smallest singular value.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(kdmax)</td><td>::</td>
  <td><strong>w</strong></td><td><p>Vector containing right-hand side of triangular system and
 least-squares residual norm in GMRES.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>rwork</strong></td><td><p>Work array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rsnrm</strong></td><td><p>GMRES residual norm on return</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dinpr_intr.html'>dinpr_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dinpr</strong></td><td><p>Inner-product routine, either user-supplied or BLAS <code>ddot</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dnorm_intr.html'>dnorm_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dnorm</strong></td><td><p>Norm routine, either user supplied or BLAS dnrm2.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>itrmks</strong></td><td><p>Termination flag. Values have the following meanings:</p>
<dl>
<dt>0</dt>
<dd>normal termination: acceptable step found</dd>
<dt>1</dt>
<dd>
<script type="math/tex">J\vec{v}</script>  failure in <code>nitjv</code></dd>
<dt>2</dt>
<dd>
<script type="math/tex">P^{-1}\vec{v}</script> failure in <code>nitjv</code></dd>
<dt>3</dt>
<dd>Acceptable step not found in <code>iksmax</code> GMRES iterations</dd>
<dt>4</dt>
<dd>Insignificant residual norm reduction of a cycle of <code>kdmax</code> 
 steps (stagnation) before an acceptable step has been found.</dd>
<dt>5</dt>
<dd>Dangerous ill-conditioning detected before an acceptable 
 step has been found.</dd>
</dl></td>
  
</tr>

</tbody>
</table>

      
    
    

    </li>
  
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-nittfq2"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
public subroutine nittfq2(n, xcur, fcur, step, eta, f, jacv, rpar, ipar, ijacv, irpre, iksmax, ifdord, nfe, njve, nrpre, nli, r, rcgs, rtil, d, p, q, u, v, y, rwork1, rwork2, rsnrm, dinpr, dnorm, itrmks)
    
    
   
</h3>
    



<p>An interface to my modified versino of the
 <a href="http://users.wpi.edu/~walker/Papers/nitsol,SISC_19,1998,302-318.pdf">nitsol</a>
 implementation of the transpose-free quasi-minimal residual
 method
 (<a href="https://epubs.siam.org/doi/pdf/10.1137/0914029">TFQMR</a>) for
 iteratively solving linear systems. It has been modified so
 that the user provides a non-zero initial guess of the
 solution.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>Dimension of the problem</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>xcur</strong></td><td><p>Array of length <code>n</code> containing the current <script type="math/tex">x</script> value</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>fcur</strong></td><td><p>Array of length <code>n</code> containing current approximate solution</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>step</strong></td><td><p>Vector of of length <code>n</code> containing trial step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eta</strong></td><td><p>Relative residual reduction factor</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/f_intr%7E2.html'>f_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td><p>User-supplied subroutine for evaluating the function
 the zero of which is sought.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/jacv_intr.html'>jacv_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>jacv</strong></td><td><p>User-supplied subroutine for optionally evaluating
 <script type="math/tex">J\vec{v}</script> or <script type="math/tex">P^{-1}\vec{v}</script>, where <script type="math/tex">J</script> is the Jacobian
 of <script type="math/tex">f</script> and <script type="math/tex">P</script> is a right preconditioning operator. If
 neither analytic <script type="math/tex">J\vec{v}</script> evaluations nor right
 preconditioning is used, this can be a dummy subroutine;
 if right preconditioning is used but not analytic
 <script type="math/tex">J\vec{v}</script> evaluations, this need only evaluate
 <script type="math/tex">P^{-1}\vec{v}</script>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array passed to the <code>f</code> and <code>jacv</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array passed to the <code>f</code> and <code>jacv</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ijacv</strong></td><td><p>Flag for determining method of <script type="math/tex">J\vec{v}</script> evaluation. 0
 (default) indicates finite-difference evaluation, while 1
 indicates analytic evaluation.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>irpre</strong></td><td><p>Flag for right preconditioning. 0 indicates no
 preconditioning, while 1 inidcates right preconditioning.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iksmax</strong></td><td><p>Maximum allowable number of TFQMR iterations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ifdord</strong></td><td><p>Order of the finite-difference formula used in TFQMR
 when J*v products are evaluated using finite-differences. 
 When ijacv = 0 on input to nitsol, ifdord is set to 1, 2, or 
 4 in nitsol; otherwise, it is irrelevant. When ijacv = 0 on 
 input to this subroutine, ifdord determines the order of the 
 finite-difference formula used at each TFQMR iteration 
 (default 1). In this case, ijacv is set to -1 below to 
 signal to nitjv that the order of the finite-difference 
 formula is to be determined by ifdord. The original value 
 ijacv = 0 is restored on return.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nfe</strong></td><td><p>Number of function evaluations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>njve</strong></td><td><p>Number of <script type="math/tex">J\vec{v}</script> evaluations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nrpre</strong></td><td><p>Number of <script type="math/tex">P^{-1}\vec{v}</script> evaluations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nli</strong></td><td><p>Number of linear iterations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>r</strong></td><td><p>Residual vector (for the QMR process)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>rcgs</strong></td><td><p>Residual vector (of the underlying CGS process)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>rtil</strong></td><td><p>'Shadow' residual vector used in bi-orthogonalization</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>d</strong></td><td><p>Vector used in TFQMR</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>p</strong></td><td><p>Vector used in TFQMR</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>q</strong></td><td><p>Vector used in TFQMR</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>u</strong></td><td><p>Vector used in TFQMR</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>v</strong></td><td><p>Vector used in TFQMR</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>y</strong></td><td><p>Vector used in TFQMR</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>rwork1</strong></td><td><p>Work vector, passed on to nitjv</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>rwork2</strong></td><td><p>Work vector, passed on to nitjv</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rsnrm</strong></td><td><p>TFQMR residual norm on return</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dinpr_intr.html'>dinpr_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dinpr</strong></td><td><p>Inner-product routine, either user-supplied or BLAS <code>ddot</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dnorm_intr.html'>dnorm_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dnorm</strong></td><td><p>Norm routine, either user supplied or BLAS dnrm2.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>itrmks</strong></td><td><p>Termination flag. Values have the following meanings:</p>
<dl>
<dt>0</dt>
<dd>normal termination: acceptable step found</dd>
<dt>1</dt>
<dd>
<script type="math/tex">J\vec{v}</script>  failure in <code>nitjv</code></dd>
<dt>2</dt>
<dd>
<script type="math/tex">P^{-1}\vec{v}</script> failure in <code>nitjv</code></dd>
<dt>3</dt>
<dd>Acceptable step not found in <code>iksmax</code> TFQMR iterations</dd>
<dt>4</dt>
<dd>TFQMR breakdown</dd>
<dt>5</dt>
<dd>Floating point error (the underlying CGS iteration
 has probably blown up)</dd>
</dl></td>
  
</tr>

</tbody>
</table>

      
    
    

    </li>
  
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-nitstb2"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
public subroutine nitstb2(n, xcur, fcur, step, eta, f, jacv, rpar, ipar, ijacv, irpre, iksmax, ifdord, nfe, njve, nrpre, nli, r, rtil, p, phat, v, t, rwork1, rwork2, rsnrm, dinpr, dnorm, itrmks)
    
    
   
</h3>
    



<p>An interface to my modified versino of the
 <a href="http://users.wpi.edu/~walker/Papers/nitsol,SISC_19,1998,302-318.pdf">nitsol</a>
 implementation of the biconjugate gradient stabilized method
 (<a href="https://en.wikipedia.org/wiki/Biconjugate_gradient_stabilized_method">BiCGSTAB</a>)
 for iteratively solving linear systems. It has been modified
 so that the user provides a non-zero initial guess of the
 solution.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>Dimension of the problem</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>xcur</strong></td><td><p>Array of length <code>n</code> containing the current <script type="math/tex">x</script> value</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>fcur</strong></td><td><p>Array of length <code>n</code> containing current approximate solution</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>step</strong></td><td><p>Vector of of length <code>n</code> containing trial step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eta</strong></td><td><p>Relative residual reduction factor</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/f_intr%7E2.html'>f_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td><p>User-supplied subroutine for evaluating the function
 the zero of which is sought.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/jacv_intr.html'>jacv_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>jacv</strong></td><td><p>User-supplied subroutine for optionally evaluating
 <script type="math/tex">J\vec{v}</script> or <script type="math/tex">P^{-1}\vec{v}</script>, where <script type="math/tex">J</script> is the Jacobian
 of <script type="math/tex">f</script> and <script type="math/tex">P</script> is a right preconditioning operator. If
 neither analytic <script type="math/tex">J\vec{v}</script> evaluations nor right
 preconditioning is used, this can be a dummy subroutine;
 if right preconditioning is used but not analytic
 <script type="math/tex">J\vec{v}</script> evaluations, this need only evaluate
 <script type="math/tex">P^{-1}\vec{v}</script>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array passed to the <code>f</code> and <code>jacv</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array passed to the <code>f</code> and <code>jacv</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ijacv</strong></td><td><p>Flag for determining method of <script type="math/tex">J\vec{v}</script> evaluation. 0
 (default) indicates finite-difference evaluation, while 1
 indicates analytic evaluation.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>irpre</strong></td><td><p>Flag for right preconditioning. 0 indicates no
 preconditioning, while 1 inidcates right preconditioning.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iksmax</strong></td><td><p>Maximum allowable number of BiCGSTAB iterations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ifdord</strong></td><td><p>Order of the finite-difference formula used in BiCGSTAB 
 when J*v products are evaluated using finite-differences. 
 When ijacv = 0 on input to nitsol, ifdord is set to 1, 2, or 
 4 in nitsol; otherwise, it is irrelevant. When ijacv = 0 on 
 input to this subroutine, ifdord determines the order of the 
 finite-difference formula used at each BiCGSTAB iteration 
 (default 1). In this case, ijacv is set to -1 below to 
 signal to nitjv that the order of the finite-difference 
 formula is to be determined by ifdord. The original value 
 ijacv = 0 is restored on return.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nfe</strong></td><td><p>Number of function evaluations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>njve</strong></td><td><p>Number of <script type="math/tex">J\vec{v}</script> evaluations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nrpre</strong></td><td><p>Number of <script type="math/tex">P^{-1}\vec{v}</script> evaluations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nli</strong></td><td><p>Number of linear iterations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>r</strong></td><td><p>Residual vector</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>rtil</strong></td><td><p>
<script type="math/tex">\tilde{r}</script> vector used in BiCGSTAB</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>p</strong></td><td><p>Vector used in BiCGSTAB</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>phat</strong></td><td><p>Vector used in BiCGSTAB</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>v</strong></td><td><p>Vector used in BiCGSTAB</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>t</strong></td><td><p>Vector used in BiCGSTAB</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>rwork1</strong></td><td><p>Work vector, passed on to nitjv</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>rwork2</strong></td><td><p>Work vector, passed on to nitjv</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rsnrm</strong></td><td><p>BiCGSTAB residual norm on return</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dinpr_intr.html'>dinpr_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dinpr</strong></td><td><p>Inner-product routine, either user-supplied or BLAS <code>ddot</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dnorm_intr.html'>dnorm_intr</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dnorm</strong></td><td><p>Norm routine, either user supplied or BLAS dnrm2.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>itrmks</strong></td><td><p>Termination flag. Values have the following meanings:</p>
<dl>
<dt>0</dt>
<dd>normal termination: acceptable step found</dd>
<dt>1</dt>
<dd>
<script type="math/tex">J\vec{v}</script>  failure in <code>nitjv</code></dd>
<dt>2</dt>
<dd>
<script type="math/tex">P^{-1}\vec{v}</script> failure in <code>nitjv</code></dd>
<dt>3</dt>
<dd>Acceptable step not found in <code>iksmax</code> BiCGSTAB iterations</dd>
<dt>4</dt>
<dd>BiCGSTAB breakdown</dd>
</dl></td>
  
</tr>

</tbody>
</table>

      
    
    

    </li>
  
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-ddot"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
public function ddot(n, x, sx, y, sy)
    
    
   
</h3>
    



<p>An interface to the BLAS routine for calculating Euclidean
 inner product. This can be passed to <a href="../interface/nitsol.html">nitsol</a> for the
 argument <code>dinpr</code>.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>x</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>sx</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>y</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>sy</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=r8)
  </small></h4>
  
    

    </li>
  
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-dnrm2"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
public function dnrm2(n, x, sx)
    
    
   
</h3>
    



<p>An interface to the BLAS routine for calculating Euclidean
 norm. This can be passed to <a href="../interface/nitsol.html">nitsol</a> for the argument
 <code>dnorm</code>.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>x</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>sx</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=r8)
  </small></h4>
  
    

    </li>
  
  </ul>
</div>

    
    </section>
  <br>
    

    
    <section>
     <h2>Abstract Interfaces</h2>
   
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-dinpr_intr"></span><h3>abstract interface
    
  </h3></div>
  
  <ul class="list-group">
    <li class="list-group-item">
    
    
    <h3>
public function dinpr_intr(n, x, sx, y, sy)
    
    
   
</h3>
    



<p>Interface for function which calculates vector inner products.
 This has the same interace as the BLAS routine
 <a href="http://www.netlib.org/lapack/explore-html/de/da4/group__double__blas__level1_ga75066c4825cb6ff1c8ec4403ef8c843a.html">ddot</a>.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>The length of the vectors</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>x</strong></td><td><p>The first input vector</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>sx</strong></td><td><p>The stride in memory between successive elements of <code>x</code></p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>y</strong></td><td><p>The second input vector</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>sy</strong></td><td><p>The stride in memory between successive elements of <code>y</code></p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=r8)
  </small></h4>
  <p>Inner product of <code>x</code> and <code>y</code></p>
    

    </li>
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-dnorm_intr"></span><h3>abstract interface
    
  </h3></div>
  
  <ul class="list-group">
    <li class="list-group-item">
    
    
    <h3>
public function dnorm_intr(n, x, sx)
    
    
   
</h3>
    



<p>Interface for function which calculates vector norms. This
 has the same interface as the BLAS routine dnrm2.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>The length of the array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>x</strong></td><td><p>The input vector</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>sx</strong></td><td><p>The stride in memory between consecutive elements of <code>x</code></p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=r8)
  </small></h4>
  <p>The vector norm of <code>x</code></p>
    

    </li>
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-mat_mult"></span><h3>abstract interface
    
  </h3></div>
  
  <ul class="list-group">
    <li class="list-group-item">
    
    
    <h3>
public function mat_mult(v, xcur, rhs, rpar, ipar, success)
    
    
   
</h3>
    



<p>Interface for operations representing the multiplication of a
 vector by a matrix, such as that for a linear operator or a
 preconditioner.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>v</strong></td><td><p>The vector to be multiplied</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>xcur</strong></td><td><p>Array containing the current estimate of the independent
 variables in the linear system. This may not be needed, but
 is provided just in case.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>rhs</strong></td><td><p>Array containing the right hand side of the linear
 system. This may not be needed, but is provided just in
 case.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array </p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>success</strong></td><td><p>Indicates whether operation was completed succesfully</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=r8),
  dimension(size(xcur))</small></h4>
  <p>Result of the operation</p>
    

    </li>
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-f_intr%7E2"></span><h3>abstract interface
    
  </h3></div>
  
  <ul class="list-group">
    <li class="list-group-item">
    
    
    <h3>
public subroutine f_intr(n, xcur, fcur, rpar, ipar, itrmf)
    
    
   
</h3>
    



<p>Interface for a subroutine which evaluates the function
 the zero of which is sought.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>Dimension of the problem</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>xcur</strong></td><td><p>Array of length <code>n</code> containing the current <script type="math/tex">x</script> value</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>fcur</strong></td><td><p>Array of length <code>n</code> containing f(xcur) on output</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>itrmf</strong></td><td><p>Termination flag. 0 means normal termination, 1 means
 failure to produce f(xcur)</p></td>
  
</tr>

</tbody>
</table>

      
    
    

    </li>
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-jacv_intr"></span><h3>abstract interface
    
  </h3></div>
  
  <ul class="list-group">
    <li class="list-group-item">
    
    
    <h3>
public subroutine jacv_intr(n, xcur, fcur, ijob, v, z, rpar, ipar, itrmjv)
    
    
   
</h3>
    



<p>Interface for a subroutine which optionally evaluates
 <script type="math/tex">J\vec{v}</script> or <script type="math/tex">P^{-1}\vec{v}</script>, where <script type="math/tex">J</script> is the Jacobian
 of <script type="math/tex">f</script> and <script type="math/tex">P</script> is a right preconditioning operator.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>Dimension of the problem</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>xcur</strong></td><td><p>Array of length <code>n</code> containing the current <script type="math/tex">x</script> value</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>fcur</strong></td><td><p>Array of length <code>n</code> containing the current <script type="math/tex">f(x)</script> value</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ijob</strong></td><td><p>Integer flag indicating which product is desired. 0
 indicates <script type="math/tex">z = J\vec{v}</script>. 1 indicates <script type="math/tex">z = P^{-1}\vec{v}</script>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>v</strong></td><td><p>An array of length <code>n</code> to be multiplied</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>z</strong></td><td><p>An array of length n containing the desired product on
 output.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array </p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>itrmjv</strong></td><td><p>Termination flag. 0 indcates normal termination, 1
 indicatesfailure to prodce <script type="math/tex">J\vec{v}</script>, and 2 indicates
 failure to produce <script type="math/tex">P^{-1}\vec{v}</script>
</p></td>
  
</tr>

</tbody>
</table>

      
    
    

    </li>
  </ul>
</div>

    
    </section>
  <br>
    
    
    
    
    

    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-dummy_jacv"></span><h3>
public subroutine <a href='../proc/dummy_jacv.html'>dummy_jacv</a>(n, xcur, fcur, ijob, v, z, rpar, ipar, itrmjv)
    
    
   
</h3></div>
  <div class="panel-body">
       
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>November 2016</dd>
    
    
    
    
  </dl>



<p>A dummy subroutine which does not apply a preconditioner or
 calculate an analytic Jacobian. This can be passed to <a href="../interface/nitsol.html">nitsol</a>
 for the argument <code>jacv</code>.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>xcur</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>fcur</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ijob</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>v</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>z</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>itrmjv</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-dummy_f"></span><h3>
public subroutine <a href='../proc/dummy_f.html'>dummy_f</a>(n, xcur, fcur, rpar, ipar, itrmf)
    
    
   
</h3></div>
  <div class="panel-body">
       
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>March 2017</dd>
    
    
    
    
  </dl>



<p>A dummy subroutine which does not calculate the function.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>Dimension of the problem</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>xcur</strong></td><td><p>Array of length <code>n</code> containing the current <script type="math/tex">x</script> value</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>fcur</strong></td><td><p>Array of length <code>n</code> containing f(xcur) on output</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>itrmf</strong></td><td><p>Termination flag. 0 means normal termination, 1 means
 failure to produce f(xcur)</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-gmres_solve"></span><h3>
public subroutine <a href='../proc/gmres_solve.html'>gmres_solve</a>(solution, lhs, rhs, resid_norm, flag, nlhs, nrpre, nli, tol, precond, rpar, ipar, resid_update, iter_max, krylov_dim, inner_prod, norm)
    
    
   
</h3></div>
  <div class="panel-body">
       
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>March 2017</dd>
    
    
    
    
  </dl>



<p>A wraper for the
 <a href="http://users.wpi.edu/~walker/Papers/nitsol,SISC_19,1998,302-318.pdf">nitsol</a>
 implementation of the generalised minimal residual method
 (<a href="https://en.wikipedia.org/wiki/Generalized_minimal_residual_method">GMRES</a>)
 for iteratively solving linear systems. This provides a more
 general interface not specifically intended for use with Newton
 iteration. It also uses Fortran 90 features to provide a more
 convenient call signature.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>solution</strong></td><td><p>On input, an initial guess of the solution to the linear
 system. On output, the iteratively determined solution.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/mat_mult.html'>mat_mult</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lhs</strong></td><td><p>The linear operator on the left hand side of the linear
 system.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>rhs</strong></td><td><p>The right hand side of the linear system being solved</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>resid_norm</strong></td><td><p>GMRES residual norm on return</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>flag</strong></td><td><p>Termination flag. Values have the following meanings:</p><a href="None" class="pull-right"><emph>Read more&hellip;</emph></a></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nlhs</strong></td><td><p>Number of evaluations of the left hand side of the system</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nrpre</strong></td><td><p>Number of evaluations of the right-preconditioner</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nli</strong></td><td><p>Number of iterations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>tol</strong></td><td><p>The tolerance for the solution. Default is <code>size(solution) * 1e-8</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/mat_mult.html'>mat_mult</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>precond</strong></td><td><p>A right-preconditioner which may be used to improve
 convergence of the solution.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array passed to the <code>lhs</code> and <code>precond</code> routines.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array passed to the <code>lhs</code> and <code>precond</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>resid_update</strong></td><td><p>Residual update flag. On GMRES restarts, the residual can
 be updated using a linear combination (<code>iresup == 0</code>) or by
 direct evaluation (<code>iresup == 1</code>). The first is cheap (one
 n-vector saxpy) but may lose accuracy with extreme residual
 reduction; the second retains accuracy better but costs one
 <script type="math/tex">J\vec{v}</script> product. Default is 0.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>iter_max</strong></td><td><p>Maximum allowable number of GMRES iterations. Default is
 1000.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>krylov_dim</strong></td><td><p>Maximum Krylov subspace dimension; default 10.    </p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dinpr_intr.html'>dinpr_intr</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>inner_prod</strong></td><td><p>Inner-product routine, either user-supplied or BLAS <code>ddot</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dnorm_intr.html'>dnorm_intr</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>norm</strong></td><td><p>Norm routine, either user supplied or BLAS dnrm2.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-tfqmr_solve"></span><h3>
public subroutine <a href='../proc/tfqmr_solve.html'>tfqmr_solve</a>(solution, lhs, rhs, resid_norm, flag, nlhs, nrpre, nli, tol, precond, rpar, ipar, resid_update, iter_max, krylov_dim, inner_prod, norm)
    
    
   
</h3></div>
  <div class="panel-body">
       
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>March 2017</dd>
    
    
    
    
  </dl>



<p>A wraper for the
 <a href="http://users.wpi.edu/~walker/Papers/nitsol,SISC_19,1998,302-318.pdf">nitsol</a>
 implementation of the transpose-free quasi-minimal residual method
 (<a href="https://epubs.siam.org/doi/pdf/10.1137/0914029">TFQMR</a>)
 for iteratively solving linear systems. This provides a more
 general interface not specifically intended for use with Newton
 iteration. It also uses Fortran 90 features to provide a more
 convenient call signature.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>solution</strong></td><td><p>On input, an initial guess of the solution to the linear
 system. On output, the iteratively determined solution.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/mat_mult.html'>mat_mult</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lhs</strong></td><td><p>The linear operator on the left hand side of the linear
 system.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>rhs</strong></td><td><p>The right hand side of the linear system being solved</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>resid_norm</strong></td><td><p>TFQMR residual norm on return</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>flag</strong></td><td><p>Termination flag. Values have the following meanings:</p><a href="None" class="pull-right"><emph>Read more&hellip;</emph></a></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nlhs</strong></td><td><p>Number of evaluations of the left hand side of the system</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nrpre</strong></td><td><p>Number of evaluations of the right-preconditioner</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nli</strong></td><td><p>Number of iterations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>tol</strong></td><td><p>The tolerance for the solution. Default is <code>size(solution) * 1e-8</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/mat_mult.html'>mat_mult</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>precond</strong></td><td><p>A right-preconditioner which may be used to improve
 convergence of the solution.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array passed to the <code>lhs</code> and <code>precond</code> routines.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array passed to the <code>lhs</code> and <code>precond</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>resid_update</strong></td><td><p>Residual update flag. On GMRES restarts, the residual can
 be updated using a linear combination (<code>iresup == 0</code>) or by
 direct evaluation (<code>iresup == 1</code>). The first is cheap (one
 n-vector saxpy) but may lose accuracy with extreme residual
 reduction; the second retains accuracy better but costs one
 <script type="math/tex">J\vec{v}</script> product. Meaningless in this routine, but kept
 for consistent interface.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>iter_max</strong></td><td><p>Maximum allowable number of TFQMR iterations. Default is
 1000.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>krylov_dim</strong></td><td><p>Maximum Krylov subspace dimension; default 10.    </p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dinpr_intr.html'>dinpr_intr</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>inner_prod</strong></td><td><p>Inner-product routine, either user-supplied or BLAS <code>ddot</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dnorm_intr.html'>dnorm_intr</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>norm</strong></td><td><p>Norm routine, either user supplied or BLAS dnrm2.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-bicgstab_solve"></span><h3>
public subroutine <a href='../proc/bicgstab_solve.html'>bicgstab_solve</a>(solution, lhs, rhs, resid_norm, flag, nlhs, nrpre, nli, tol, precond, rpar, ipar, resid_update, iter_max, krylov_dim, inner_prod, norm)
    
    
   
</h3></div>
  <div class="panel-body">
       
    





  <dl class="dl-horizontal">
    
    <dt>Author</dt><dd>Chris MacMackin</dd>
    
    
    <dt>Date</dt><dd>March 2017</dd>
    
    
    
    
  </dl>



<p>A wraper for the
 <a href="http://users.wpi.edu/~walker/Papers/nitsol,SISC_19,1998,302-318.pdf">nitsol</a>
 implementation of the biconjugate gradient stabilized method
 (<a href="https://en.wikipedia.org/wiki/Biconjugate_gradient_stabilized_method">BiCGSTAB</a>)
 for iteratively solving linear systems. This provides a more
 general interface not specifically intended for use with Newton
 iteration. It also uses Fortran 90 features to provide a more
 convenient call signature.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>solution</strong></td><td><p>On input, an initial guess of the solution to the linear
 system. On output, the iteratively determined solution.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/mat_mult.html'>mat_mult</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lhs</strong></td><td><p>The linear operator on the left hand side of the linear
 system.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>rhs</strong></td><td><p>The right hand side of the linear system being solved</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>resid_norm</strong></td><td><p>BiCGSTAB residual norm on return</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>flag</strong></td><td><p>Termination flag. Values have the following meanings:</p><a href="None" class="pull-right"><emph>Read more&hellip;</emph></a></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nlhs</strong></td><td><p>Number of evaluations of the left hand side of the system</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nrpre</strong></td><td><p>Number of evaluations of the right-preconditioner</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nli</strong></td><td><p>Number of iterations</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>tol</strong></td><td><p>The tolerance for the solution. Default is <code>size(solution) * 1e-8</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/mat_mult.html'>mat_mult</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>precond</strong></td><td><p>A right-preconditioner which may be used to improve
 convergence of the solution.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=r8),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>rpar</strong></td><td><p>Parameter/work array passed to the <code>lhs</code> and <code>precond</code> routines.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>ipar</strong></td><td><p>Parameter/work array passed to the <code>lhs</code> and <code>precond</code> routines</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>resid_update</strong></td><td><p>Residual update flag. On GMRES restarts, the residual can be
 updated using a linear combination (<code>iresup == 0</code>) or by
 direct evaluation (<code>iresup == 1</code>). The first is cheap (one
 n-vector saxpy) but may lose accuracy with extreme residual
 reduction; the second retains accuracy better but costs one
 <script type="math/tex">J\vec{v}</script> product. Meaningless in this routine, but kept
 for consistent interface.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>iter_max</strong></td><td><p>Maximum allowable number of TFQMR iterations. Default is
 1000.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>krylov_dim</strong></td><td><p>Maximum Krylov subspace dimension; default 10.    </p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dinpr_intr.html'>dinpr_intr</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>inner_prod</strong></td><td><p>Inner-product routine, either user-supplied or BLAS <code>ddot</code>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(<a href='../interface/dnorm_intr.html'>dnorm_intr</a>),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>norm</strong></td><td><p>Norm routine, either user supplied or BLAS dnrm2.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    </section>    
    <br>
    
    
    
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ISOFT was developed by Chris MacMackin</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="../js/MathJax-config/mj-config.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>